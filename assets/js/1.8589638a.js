(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{360:function(t,e,r){"use strict";r(158);var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.v3=e.Vec3=void 0;var o=r(365),s=r(361),a=r(366),h=function(t){function e(e,r,i){void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0);var n=t.call(this)||this;return n._x=e,n._y=r,n._z=i,n}return n(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.fire("change","x",this._x,t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.fire("change","y",this._y,t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this.fire("change","z",this._z,t))},enumerable:!1,configurable:!0}),e.isVec3=function(t){return!isNaN(t.x)&&!isNaN(t.y)&&!isNaN(t.z)&&isNaN(t.w)},Object.defineProperty(e.prototype,"isVec3",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Up",{get:function(){return new e(0,1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Down",{get:function(){return new e(0,1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UnitX",{get:function(){return new e(1,0,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UnitY",{get:function(){return new e(0,1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UnitZ",{get:function(){return new e(0,0,1)},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,r){return this._x=t,this._y=e,this._z=r,this.fire("change"),this},e.prototype.setScalar=function(t){return this._x=t,this._y=t,this._z=t,this.fire("change"),this},e.prototype.setComponent=function(t,e){switch(t){case 0:this._x=e;break;case 1:this._y=e;break;case 2:this._z=e;break;default:throw new Error("index is out of range: "+t)}return this},e.prototype.getComponent=function(t){switch(t){case 0:return this._x;case 1:return this._y;case 2:return this._z;default:throw new Error("index is out of range: "+t)}},e.prototype.clone=function(){return new e(this._x,this._y,this._z)},e.prototype.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this.fire("change"),this},e.prototype.add=function(t,e){return void 0!==e?(console.warn("Vec3: .add() now only accepts one argument. Use .addVecs( a, b ) instead."),this.addVecs(t,e)):(this._x+=t.x,this._y+=t.y,this._z+=t.z,this.fire("change"),this)},e.prototype.addScalar=function(t){return this._x+=t,this._y+=t,this._z+=t,this.fire("change"),this},e.prototype.addVecs=function(t,e){return this._x=t.x+e.x,this._y=t.y+e.y,this._z=t.z+e.z,this.fire("change"),this},e.prototype.addScaledVec=function(t,e){return this._x+=t.x*e,this._y+=t.y*e,this._z+=t.z*e,this.fire("change"),this},e.prototype.sub=function(t,e){return void 0!==e?(console.warn("Vec3: .sub() now only accepts one argument. Use .subVecs( a, b ) instead."),this.subVecs(t,e)):(this._x-=t.x,this._y-=t.y,this._z-=t.z,this.fire("change"),this)},e.prototype.subScalar=function(t){return this._x-=t,this._y-=t,this._z-=t,this.fire("change"),this},e.prototype.subVecs=function(t,e){return this._x=t.x-e.x,this._y=t.y-e.y,this._z=t.z-e.z,this.fire("change"),this},e.prototype.multiply=function(t,e){return void 0!==e?this.multiplyVecs(t,e):(this._x*=t.x,this._y*=t.y,this._z*=t.z,this.fire("change"),this)},e.prototype.multiplyScalar=function(t){return this._x*=t,this._y*=t,this._z*=t,this.fire("change"),this},e.prototype.multiplyVecs=function(t,e){return this._x=t.x*e.x,this._y=t.y*e.y,this._z=t.z*e.z,this.fire("change"),this},e.prototype.applyEuler=function(t){return t&&t.isEuler||console.error("Vec3: .applyEuler() now expects an Euler rotation rather than a Vec3 and order."),this.applyQuat(u.setFromEuler(t))},e.prototype.applyAxisAngle=function(t,e){return this.applyQuat(u.setFromAxisAngle(t,e))},e.prototype.applyNormalMat=function(t){return this.applyMat3(t).normalize()},e.prototype.applyMat3=function(t){var e=this._x,r=this._y,i=this._z,n=t.elements;return this._x=n[0]*e+n[3]*r+n[6]*i,this._y=n[1]*e+n[4]*r+n[7]*i,this._z=n[2]*e+n[5]*r+n[8]*i,this.fire("change"),this},e.prototype.applyMat4=function(t){var e=this._x,r=this._y,i=this._z,n=t.elements,o=1/(n[3]*e+n[7]*r+n[11]*i+n[15]);return this._x=(n[0]*e+n[4]*r+n[8]*i+n[12])*o,this._y=(n[1]*e+n[5]*r+n[9]*i+n[13])*o,this._z=(n[2]*e+n[6]*r+n[10]*i+n[14])*o,this.fire("change"),this},e.prototype.applyQuat=function(t){var e=this._x,r=this._y,i=this._z,n=t.x,o=t.y,s=t.z,a=t.w,h=a*e+o*i-s*r,c=a*r+s*e-n*i,u=a*i+n*r-o*e,l=-n*e-o*r-s*i;return this._x=h*a+l*-n+c*-s-u*-o,this._y=c*a+l*-o+u*-n-h*-s,this._z=u*a+l*-s+h*-o-c*-n,this.fire("change"),this},e.prototype.project=function(t){return this.applyMat4(t.matrixWorldInverse).applyMat4(t.projectionMat)},e.prototype.unproject=function(t){return this.applyMat4(t.projectionMatInverse).applyMat4(t.matrixWorld)},e.prototype.transformDirection=function(t){var e=this._x,r=this._y,i=this._z,n=t.elements;return this._x=n[0]*e+n[4]*r+n[8]*i,this._y=n[1]*e+n[5]*r+n[9]*i,this._z=n[2]*e+n[6]*r+n[10]*i,this.fire("change"),this.normalize()},e.prototype.divide=function(t){return this._x/=t.x,this._y/=t.y,this._z/=t.z,this.fire("change"),this},e.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},e.prototype.min=function(t){return this._x=Math.min(this._x,t.x),this._y=Math.min(this._y,t.y),this._z=Math.min(this._z,t.z),this.fire("change"),this},e.prototype.max=function(t){return this._x=Math.max(this._x,t.x),this._y=Math.max(this._y,t.y),this._z=Math.max(this._z,t.z),this.fire("change"),this},e.prototype.clamp=function(t,e){return this._x=Math.max(t.x,Math.min(e.x,this._x)),this._y=Math.max(t.y,Math.min(e.y,this._y)),this._z=Math.max(t.z,Math.min(e.z,this._z)),this.fire("change"),this},e.prototype.clampScalar=function(t,e){return this._x=Math.max(t,Math.min(e,this._x)),this._y=Math.max(t,Math.min(e,this._y)),this._z=Math.max(t,Math.min(e,this._z)),this.fire("change"),this},e.prototype.clampLength=function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},e.prototype.floor=function(){return this._x=Math.floor(this._x),this._y=Math.floor(this._y),this._z=Math.floor(this._z),this.fire("change"),this},e.prototype.ceil=function(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this._z=Math.ceil(this._z),this.fire("change"),this},e.prototype.round=function(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this._z=Math.round(this._z),this.fire("change"),this},e.prototype.roundToZero=function(){return this._x=this._x<0?Math.ceil(this._x):Math.floor(this._x),this._y=this._y<0?Math.ceil(this._y):Math.floor(this._y),this._z=this._z<0?Math.ceil(this._z):Math.floor(this._z),this.fire("change"),this},e.prototype.negate=function(){return this._x=-this._x,this._y=-this._y,this._z=-this._z,this.fire("change"),this},e.prototype.dot=function(t){return this._x*t.x+this._y*t.y+this._z*t.z},e.prototype.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z},e.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)},e.prototype.manhattanLength=function(){return Math.abs(this._x)+Math.abs(this._y)+Math.abs(this._z)},e.prototype.normalize=function(t){return void 0===t&&(t=!1),this.divideScalar(this.length()||1)},e.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},e.prototype.lerp=function(t,e){return this._x+=(t.x-this._x)*e,this._y+=(t.y-this._y)*e,this._z+=(t.z-this._z)*e,this},e.prototype.lerpVecs=function(t,e,r){return this.subVecs(e,t).multiplyScalar(r).add(t)},e.prototype.slerp=function(t,e){return this.slerpVecs(this,t,e)},e.prototype.slerpVecs=function(t,e,r){this.crossVecs(t,e).normalize(),u.setFromAxisAngle(this,r),this.applyQuat(u)},e.prototype.cross=function(t,e){return void 0!==e?(console.warn("Vec3: .cross() now only accepts one argument. Use .crossVecs( a, b ) instead."),this.crossVecs(t,e)):this.crossVecs(this,t)},e.prototype.crossVecs=function(t,e){var r=t.x,i=t.y,n=t.z,o=e.x,s=e.y,a=e.z;return this._x=i*a-n*s,this._y=n*o-r*a,this._z=r*s-i*o,this},e.prototype.projectOnVec=function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},e.prototype.projectOnPlaneNormal=function(t){return c.copy(this).projectOnVec(t),this.sub(c)},e.prototype.projectOnPlaneNormalDis=function(t,e){var r=t.dot(this)-e;return c.copy(t).multiplyScalar(r),this.sub(c)},e.prototype.projectOnPlane=function(t){var e=t.normal.dot(this)-t.w;return c.copy(t.normal).multiplyScalar(e),this.sub(c)},e.prototype.projectDirectionOnPlane=function(t,e){var r=t.normal.dot(this)-t.w;c.copy(t.normal).multiplyScalar(r),c.negate().add(this);var i=this.distanceTo(c)/t.normal.dot(e);return this.add(c.copy(e).negate().multiplyScalar(i)),this},e.prototype.reflect=function(t){return this.sub(c.copy(t).multiplyScalar(2*this.dot(t)))},e.prototype.angleTo=function(t,e){if(e)return this.angleToEx(t,e);var r=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(s.clamp(r,-1,1))},e.prototype.angleToEx=function(t,e){var r=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return this.clone().cross(t).dot(e)>0?Math.acos(s.clamp(r,-1,1)):2*Math.PI-Math.acos(s.clamp(r,-1,1))},e.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},e.prototype.distanceToSquared=function(t){var e=this._x-t.x,r=this._y-t.y,i=this._z-t.z;return e*e+r*r+i*i},e.prototype.manhattanDistanceTo=function(t){return Math.abs(this._x-t.x)+Math.abs(this._y-t.y)+Math.abs(this._z-t.z)},e.prototype.setFromSpherical=function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},e.prototype.setFromSphericalCoords=function(t,e,r){var i=Math.sin(e)*t;return this._x=i*Math.sin(r),this._y=Math.cos(e)*t,this._z=i*Math.cos(r),this},e.prototype.setFromCylindrical=function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},e.prototype.setFromCylindricalCoords=function(t,e,r){return this._x=t*Math.sin(e),this._y=r,this._z=t*Math.cos(e),this},e.prototype.setFromMatPosition=function(t){var e=t.elements;return this._x=e[12],this._y=e[13],this._z=e[14],this},e.prototype.setFromMatScale=function(t){var e=this.setFromMatColumn(t,0).length(),r=this.setFromMatColumn(t,1).length(),i=this.setFromMatColumn(t,2).length();return this._x=e,this._y=r,this._z=i,this},e.prototype.setFromMatColumn=function(t,e){return this.fromArray(t.elements,4*e)},e.prototype.equals=function(t){return t.x===this._x&&t.y===this._y&&t.z===this._z},e.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this},e.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t},e.prototype.fromBufferAttribute=function(t,e,r){return void 0!==r&&console.warn("Vec3: offset has been removed from .fromBufferAttribute()."),this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this},e.prototype.toFixed=function(t){return void 0!==t&&(this._x=parseFloat(this._x.toFixed(t)),this._y=parseFloat(this._y.toFixed(t)),this._z=parseFloat(this._z.toFixed(t))),this},e.prototype.distancePoint=function(t){var e={};return e.distanceSqr=this.distanceToSquared(t),e.distance=Math.sqrt(e.distanceSqr),e},e.prototype.distanceVec3=function(t){return this.distancePoint(t)},e.prototype.distanceLine=function(t){var e={parameters:[],closests:[]},r=this.clone().sub(t.origin),i=t.direction.dot(r),n=t.direction.clone().multiplyScalar(i).add(t.origin);return e.parameters.push(0,i),e.closests.push(this,n),r=e.closests[0].clone().sub(e.closests[1]),e.distanceSqr=r.dot(r),e.distance=Math.sqrt(e.distanceSqr),e},e.prototype.distanceRay=function(t){var e={parameters:[0],closests:[this]},r=this.clone().sub(t.origin);return e.parameters[1]=t.direction.dot(r),e.parameters[1]>0?e.closests[1]=t.direction.clone().multiplyScalar(e.parameters[1]).add(t.origin):e.closests[1]=t.origin.clone(),r=this.clone().sub(e.closests[1]),e.distanceSqr=r.dot(r),e.distance=Math.sqrt(e.distanceSqr),e},e.prototype.distanceSegment=function(t){var e={parameters:[],closests:[]},r=this.clone().sub(t.p1),i=t.extentDirection.dot(r);if(i>=0)e.parameters[1]=1,e.closests[1]=t.p1;else if(r=this.clone().sub(t.p0),(i=t.extentDirection.dot(r))<=0)e.parameters[1]=0,e.closests[1]=t.p0;else{var n=t.extentSqr;n<=0&&(n=0),i/=n,e.parameters[1]=i,e.closests[1]=t.extentDirection.clone().multiplyScalar(i).add(t.p0)}return e.closests[0]=this,r=this.clone().sub(e.closests[1]),e.distanceSqr=r.dot(r),e.distance=Math.sqrt(e.distanceSqr),e},e.prototype.distancePlane=function(t){var e={parameters:[],closests:[],signedDistance:0,distance:0};return e.signedDistance=this.clone().dot(t.normal)-t.w,e.distance=Math.abs(e.signedDistance),e.closests[1]=this.clone().sub(t.normal.clone().multiplyScalar(e.signedDistance)),e},e.prototype.distanceCircle=function(t){var e={parameters:[],closests:[],equidistant:!1},r=this.clone().sub(t.center),i=r.clone().sub(t.normal.clone().multiplyScalar(t.normal.dot(r))),n=i.length();if(n>s.delta4)e.circleClosest=i.clone().multiplyScalar(t.radius/n).add(t.center),e.equidistant=!1;else{var o=t.center.clone().add(l(10,10,10)).sub(t.center),a=o.clone().sub(t.normal.clone().multiplyScalar(t.normal.dot(o))).normalize();e.circleClosest=a.clone().multiplyScalar(t.radius).add(t.center),e.equidistant=!0}e.closests.push(this,e.circleClosest);var h=this.clone().sub(e.circleClosest);return e.distanceSqr=h.dot(h),e.distance=Math.sqrt(e.distanceSqr),e},e.prototype.distanceDisk=function(t){var e={parameters:[],closests:[],signedDistance:1,distanceSqr:0,distance:0},r=this.clone().sub(t.center),i=r.clone().sub(t.normal.clone().multiplyScalar(t.normal.dot(r))),n=i.length();if(e.signedDistance=this.clone().dot(t.normal)-t.w,n>t.radius)e.diskClosest=i.clone().multiplyScalar(t.radius/n).add(t.center);else{var o=this.clone().dot(t.normal)-t.w;e.diskClosest=this.clone().sub(t.normal.clone().multiplyScalar(o))}e.closests.push(this,e.diskClosest);var s=this.clone().sub(e.diskClosest);return e.distanceSqr=s.dot(s),e.distance=Math.sqrt(e.distanceSqr),e},e.prototype.distancePolyline=function(t){for(var e,r=1/0,i=-1,n=null,o=0;o<t.length-1;o++){var s=void 0,h=void 0;Array.isArray(t)?(s=t[o],h=t[o+1]):(s=t.get(o),h=t.get(o+1)),Math.abs(s.x-this._x)>r&&Math.abs(h.x-this._x)>r&&(s.x-this._x)*(h.x-this._x)>0||(Math.abs(s.y-this._y)>r&&Math.abs(h.y-this._y)>r&&(s.y-this._y)*(h.y-this._y)>0||Math.abs(s.z-this._z)>r&&Math.abs(h.z-this._z)>r&&(s.z-this._z)*(h.z-this._z)>0||(e=this.distanceSegment(new a.Segment(s,h))).distance<r&&(r=e.distance,n=e,i=o))}return n.segmentIndex=i,n},e.prototype.distanceTriangle=function(t){function e(t,e,r){r[0]=0,r[1]=e>=0?0:t+e<=0?1:-e/t}function r(t,e,r,i,n,o){var s=t+r-i;if(s>=0)o[1]=0;else{var a=e+r-n;o[1]=a<=0?1:s/(s-a)}o[0]=1-o[1]}function i(t,e,r,i,n){var o=e/(e-i);n[0]=(1-o)*t[0]+o*r[0],n[1]=(1-o)*t[1]+o*r[1]}var n,o,s,a=this.clone().sub(t.p0),h=t.p1.clone().sub(t.p0),c=t.p2.clone().sub(t.p0),u=h.dot(h),l=h.dot(c),p=c.dot(c),f=-a.dot(h),y=-a.dot(c),d=f,_=f+u,v=f+l,m=[0,0],g=[0,0],x=[0,0];d>=0?v>=0?e(p,y,x):(m[0]=0,m[1]=d/(d-v),g[0]=v/(v-_),g[1]=1-g[0],(o=(n=g[1]-m[1])*(p*m[1]+y))>=0?e(p,y,x):(s=n*(l*g[0]+p*g[1]+y))<=0?r(l,p,y,_,v,x):i(m,o,g,s,x)):v<=0?_<=0?r(l,p,y,_,v,x):(m[0]=d/(d-_),m[1]=0,g[0]=v/(v-_),g[1]=1-g[0],(o=g[1]*(l*m[0]+y))>=0?x=m:(s=g[1]*(l*g[0]+p*g[1]+y))<=0?r(l,p,y,_,v,x):i(m,o,g,s,x)):_<=0?(m[0]=0,m[1]=d/(d-v),g[0]=v/(v-_),g[1]=1-g[0],(o=(n=g[1]-m[1])*(p*m[1]+y))>=0?e(p,y,x):(s=n*(l*g[0]+p*g[1]+y))<=0?r(l,p,y,_,v,x):i(m,o,g,s,x)):(m[0]=d/(d-_),m[1]=0,g[0]=0,g[1]=d/(d-v),(o=g[1]*(l*m[0]+y))>=0?x=m:(s=g[1]*(p*g[1]+y))<=0?e(p,y,x):i(m,o,g,s,x));var b={closests:[],parameters:[],triangleParameters:[]};b.triangleParameters[0]=1-x[0]-x[1],b.triangleParameters[1]=x[0],b.triangleParameters[2]=x[1];var w=t.p0.clone().add(h.multiplyScalar(x[0])).add(c.multiplyScalar(x[1]));return b.parameters.push(0,b.triangleParameters),b.closests.push(this,w),a=this.clone().sub(w),b.distanceSqr=a.dot(a),b.distance=Math.sqrt(b.distanceSqr),b},e.prototype.distanceRectangle=function(t){var e={rectangleParameters:[],parameters:[],closests:[]},r=t.center.clone().sub(this),i=r.dot(t.axis[0]),n=r.dot(t.axis[1]),o=-i,s=-n;e.distanceSqr=r.dot(r),o<-t.extent[0]?o=-t.extent[0]:o>t.extent[0]&&(o=t.extent[0]),e.distanceSqr+=o*(o+2*i),s<-t.extent[1]?s=-t.extent[1]:s>t.extent[1]&&(s=t.extent[1]),e.distanceSqr+=s*(s+2*n),e.distanceSqr<0&&(e.distanceSqr=0),e.distance=Math.sqrt(e.distanceSqr),e.rectangleParameters[0]=o,e.rectangleParameters[1]=s;for(var a=t.center.clone(),h=0;h<2;++h)a.add(t.axis[h].multiplyScalar(e.rectangleParameters[h]));return e.closests[0]=this,e.closests[1]=a,e},e.prototype.distanceCapsule=function(t){var e=this.distanceSegment(t);e.distance=e.distance-t.radius;var r=this.clone().sub(e.closests[1]).normalize().multiplyScalar(t.radius);return e.interior=e.distance<0,e.closests=[this,r],e},e}(r(364).EventHandler);e.Vec3=h;var c=l(),u=o.quat();function l(t,e,r){return new h(t,e,r)}e.v3=l},361:function(t,e,r){"use strict";function i(t,e){return t instanceof Number?parseFloat(t.toFixed(e)):(void 0!==t.x&&(t.x=parseFloat(t.x.toFixed(e))),void 0!==t.y&&(t.y=parseFloat(t.y.toFixed(e))),void 0!==t.z&&(t.z=parseFloat(t.z.toFixed(e))),t)}Object.defineProperty(e,"__esModule",{value:!0}),e.toFixedAry=e.toFixed=e.ToDegrees=e.toRadians=e.floorPowerOfTwo=e.ceilPowerOfTwo=e.isPowerOfTwo=e.randFloat=e.randInt=e.smootherstep=e.smoothstep=e.lerp=e.clamp=e.approximateEqual=e.sign=e.RADIANS_PER_ARCSECOND=e.DEGREES_PER_RADIAN=e.RADIANS_PER_DEGREE=e.ONE_OVER_TWO_PI=e.PI_TWO=e.THREE_PI_OVER_TWO=e.PI_OVER_SIX=e.PI_OVER_FOUR=e.PI_OVER_THREE=e.PI_OVER_TWO=e.ONE_OVER_PI=e.PI=e.delta9=e.delta8=e.delta7=e.delta6=e.delta5=e.delta4=void 0,e.delta4=1e-4,e.delta5=1e-5,e.delta6=1e-6,e.delta7=1e-7,e.delta8=1e-8,e.delta9=1e-9,e.PI=Math.PI,e.ONE_OVER_PI=1/Math.PI,e.PI_OVER_TWO=Math.PI/2,e.PI_OVER_THREE=Math.PI/3,e.PI_OVER_FOUR=Math.PI/4,e.PI_OVER_SIX=Math.PI/6,e.THREE_PI_OVER_TWO=3*Math.PI/2,e.PI_TWO=2*Math.PI,e.ONE_OVER_TWO_PI=1/(2*Math.PI),e.RADIANS_PER_DEGREE=Math.PI/180,e.DEGREES_PER_RADIAN=180/Math.PI,e.RADIANS_PER_ARCSECOND=e.RADIANS_PER_DEGREE/3600,e.sign=function(t){return t>=0?1:-1},e.approximateEqual=function(t,r,i){return void 0===i&&(i=e.delta4),Math.abs(t-r)<i},e.clamp=function(t,e,r){return Math.max(e,Math.min(r,t))},e.lerp=function(t,e,r){return(1-r)*t+r*e},e.smoothstep=function(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e))*t*(3-2*t)},e.smootherstep=function(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e))*t*t*(t*(6*t-15)+10)},e.randInt=function(t,e){return t+Math.floor(Math.random()*(e-t+1))},e.randFloat=function(t,e){return t+Math.random()*(e-t)},e.isPowerOfTwo=function(t){return 0==(t&t-1)&&0!==t},e.ceilPowerOfTwo=function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},e.floorPowerOfTwo=function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},e.toRadians=function(t){return t*e.RADIANS_PER_DEGREE},e.ToDegrees=function(t){return t*e.DEGREES_PER_RADIAN},e.toFixed=i,e.toFixedAry=function t(r,n){void 0===n&&(n=e.delta4);for(var o=0;o<r.length;o++){var s=r[o];s instanceof Array?t(s):r[o]=i(s,n)}}},363:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.angle=e.calcCircleFromThreePoint=e.pointsCollinear=e.isInOnePlane=e.recognitionPlane=e.projectOnPlane=e.reverseOnPlane=e.simplifyPointList=e.applyMatrix4=e.scale=e.rotateByUnitVectors=e.rotate=e.translate=e.applyQuat=e.boundingBox=e.vectorCompare=e.clone=void 0;var i=r(360),n=r(361),o=r(367),s=r(405),a=r(365),h=r(378),c=r(384),u=function(t,e){return t.x!==e.x?t.x-e.x:t.y!==e.y?t.y-e.y:t.z-e.z};i.v3();function l(t){if(!c.isDefined(t))return t;if(Array.isArray(t)){for(var e=new Array,r=0;r<t.length;r++)e[r]=l(t[r]);return e}return t.clone?t.clone():t}function p(t,e){return t.x===e.x?void 0!==t.z&&t.y===e.y?t.z-e.z:t.y-e.y:t.x-e.x}function f(t,e,r){return void 0===r&&(r=!0),r?(t.flat(1/0).forEach((function(t){t.applyQuat(e)})),t):f(l(t),e)}function y(t){t.sort(p);for(var e=new o.Line(t[0],t.get(-1)),r=-1/0,i=-1,n=1;n<t.length-1;n++){var s=t[n],a=e.distancePoint(s).distance;a>r&&(r=a,i=n)}var c=new h.Plane;return c.setFromThreePoint(t[0],t.get(-1),t[i]),c}e.clone=l,e.vectorCompare=p,e.boundingBox=function(t){for(var e=new i.Vec3(1/0,1/0,1/0),r=new i.Vec3(-1/0,-1/0,-1/0),n=0;n<t.length;n++)e.min(t[n]),r.max(t[n]);return[e,r]},e.applyQuat=f,e.translate=function t(e,r,i){return void 0===i&&(i=!0),i?(e.flat(1/0).forEach((function(t){t.add(r)})),e):t(l(e),r)},e.rotate=function(t,e,r,i){return void 0===i&&(i=!0),f(t,(new a.Quat).setFromAxisAngle(e,r),i)},e.rotateByUnitVectors=function(t,e,r,i){return void 0===i&&(i=!0),f(t,(new a.Quat).setFromUnitVecs(e,r),i)},e.scale=function t(e,r,i){return void 0===i&&(i=!0),i?(e.flat(1/0).forEach((function(t){t.multiply(r)})),e):t(l(e),r)},e.applyMatrix4=function t(e,r,i){return void 0===i&&(i=!0),i?(e.flat(1/0).forEach((function(t){t.applyMatrix4(r)})),e):t(l(e),r)},e.simplifyPointList=function(t,e,r){void 0===e&&(e=.1),void 0===r&&(r=Math.PI/180*5);for(var i=0;i<t.length;i++){var n=t[i],o=t[i+1];n.distanceTo(o)<e&&(0===i?t.remove(i+1,1):i===t.length-2?t.splice(i,1):t.splice(i,2,n.clone().add(o).multiplyScalar(.5)),i--)}for(i=1;i<t.length-1;i++){var s=t[i-1];n=t[i],o=t[i+1];Math.acos(n.clone().sub(s).normalize().dot(o.clone().sub(n).normalize()))<r&&(t.splice(i,1),i--)}return t},e.reverseOnPlane=function(t,e){},e.projectOnPlane=function(t,e,r){return t},e.recognitionPlane=y,e.isInOnePlane=function(t,e){void 0===e&&(e=n.delta4);for(var r=y(t),i=0;i<t.length;i++){var o=t[i];if(r.distancePoint(o)>=e)return!1}return r},e.pointsCollinear=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.sort(u);for(var r=t[t.length-1].clone().sub(t[0]),i=t[t.length-1].distanceTo(t[0]),o=1;o<t.length-1;o++){var s=t[o].distanceTo(t[0]),a=t[o].distanceTo(t[t.length-1]);if(s<a){if(Math.abs(t[o].clone().sub(t[0]).dot(r)-i*s)>n.delta4)return!1}else if(Math.abs(t[o].clone().sub(t[t.length-1]).dot(r)-i*a)>n.delta4)return!1}return!0},e.calcCircleFromThreePoint=function(t,e,r){return(new s.Circle).setFrom3Points(t,e,r)},e.angle=function(t,e,r){return t.angleTo(e,r)}},364:function(t,e,r){"use strict";var i=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,n++)i[n]=o[s];return i};Object.defineProperty(e,"__esModule",{value:!0}),e.EventHandler=void 0;var n=function(){function t(){this._callbacks={},this._callbackActive={}}return t.prototype._addCallback=function(t,e,r,i){t&&"string"==typeof t&&e&&(this._callbacks[t]||(this._callbacks[t]=[]),this._callbackActive[t]&&this._callbackActive[t]===this._callbacks[t]&&(this._callbackActive[t]=this._callbackActive[t].slice()),this._callbacks[t].push({callback:e,scope:r||this,once:i||!1}))},t.prototype.on=function(t,e,r){var i=this;return Array.isArray(t)?t.forEach((function(t){return i._addCallback(t,e,r,!1)})):this._addCallback(t,e,r,!1),this},t.prototype.off=function(t,e,r){if(t)this._callbackActive[t]&&this._callbackActive[t]===this._callbacks[t]&&(this._callbackActive[t]=this._callbackActive[t].slice());else for(var i in this._callbackActive)this._callbacks[i]&&this._callbacks[i]===this._callbackActive[i]&&(this._callbackActive[i]=this._callbackActive[i].slice());if(t)if(e){var n=this._callbacks[t];if(!n)return this;for(var o=n.length,s=0;s<o;s++)n[s].callback===e&&(r&&n[s].scope!==r||(n[s--]=n[--o]));n.length=o}else this._callbacks[t]&&(this._callbacks[t]=[]);else this._callbacks={};return this},t.prototype.fire=function(t){for(var e,r,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(!t||!this._callbacks[t])return this;this._callbackActive[t]?(this._callbackActive[t]===this._callbacks[t]&&(this._callbackActive[t]=this._callbackActive[t].slice()),r=this._callbacks[t].slice()):this._callbackActive[t]=this._callbacks[t];for(var s=0;(r||this._callbackActive[t])&&s<(r||this._callbackActive[t]).length;s++){var a=(r||this._callbackActive[t])[s];if((e=a.callback).call.apply(e,i([a.scope],n)),a.once){var h=this._callbacks[t].indexOf(a);-1!==h&&(this._callbackActive[t]===this._callbacks[t]&&(this._callbackActive[t]=this._callbackActive[t].slice()),this._callbacks[t].splice(h,1))}}return r||(this._callbackActive[t]=null),this},t.prototype.once=function(t,e,r){return this._addCallback(t,e,r,!0),this},t.prototype.hasEvent=function(t){return this._callbacks[t]&&0!==this._callbacks[t].length||!1},t}();e.EventHandler=n},365:function(t,e,r){"use strict";r(158);var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.quat=e.Quat=void 0;var o=r(361),s=function(t){function e(e,r,i,n){void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=1);var o=t.call(this)||this;return o._x=e,o._y=r,o._z=i,o._w=n,o.isQuat=!0,o}return n(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.fire("change","x",this._x,t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.fire("change","y",this._y,t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this.fire("change","z",this._z,t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"w",{get:function(){return this._w},set:function(t){this._w!==t&&(this._w=t,this.fire("change","w",this._w,t))},enumerable:!1,configurable:!0}),e.slerp=function(t,e,r,i){return r.copy(t).slerp(e,i)},e.slerpFlat=function(t,e,r,i,n,o,s){var a=r[i+0],h=r[i+1],c=r[i+2],u=r[i+3],l=n[o+0],p=n[o+1],f=n[o+2],y=n[o+3];if(u!==y||a!==l||h!==p||c!==f){var d=1-s,_=a*l+h*p+c*f+u*y,v=_>=0?1:-1,m=1-_*_;if(m>Number.EPSILON){var g=Math.sqrt(m),x=Math.atan2(g,_*v);d=Math.sin(d*x)/g,s=Math.sin(s*x)/g}var b=s*v;if(a=a*d+l*b,h=h*d+p*b,c=c*d+f*b,u=u*d+y*b,d===1-s){var w=1/Math.sqrt(a*a+h*h+c*c+u*u);a*=w,h*=w,c*=w,u*=w}}t[e]=a,t[e+1]=h,t[e+2]=c,t[e+3]=u},e.multiplyQuatsFlat=function(t,e,r,i,n,o){var s=r[i],a=r[i+1],h=r[i+2],c=r[i+3],u=n[o],l=n[o+1],p=n[o+2],f=n[o+3];return t[e]=s*f+c*u+a*p-h*l,t[e+1]=a*f+c*l+h*u-s*p,t[e+2]=h*f+c*p+s*l-a*u,t[e+3]=c*f-s*u-a*l-h*p,t},e.prototype.set=function(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._w=i,this.fire("change",this),this},e.prototype.clone=function(){return new e(this._x,this._y,this._z,this._w)},e.prototype.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.fire("change",this),this},e.prototype.setFromEuler=function(t,e){if(!t||!t.isEuler)throw new Error("Quat: .setFromEuler() now expects an Euler rotation rather than a Vec3 and order.");var r=t._x,i=t._y,n=t._z,o=t.order,s=Math.cos,a=Math.sin,h=s(r/2),c=s(i/2),u=s(n/2),l=a(r/2),p=a(i/2),f=a(n/2);return"XYZ"===o?(this._x=l*c*u+h*p*f,this._y=h*p*u-l*c*f,this._z=h*c*f+l*p*u,this._w=h*c*u-l*p*f):"YXZ"===o?(this._x=l*c*u+h*p*f,this._y=h*p*u-l*c*f,this._z=h*c*f-l*p*u,this._w=h*c*u+l*p*f):"ZXY"===o?(this._x=l*c*u-h*p*f,this._y=h*p*u+l*c*f,this._z=h*c*f+l*p*u,this._w=h*c*u-l*p*f):"ZYX"===o?(this._x=l*c*u-h*p*f,this._y=h*p*u+l*c*f,this._z=h*c*f-l*p*u,this._w=h*c*u+l*p*f):"YZX"===o?(this._x=l*c*u+h*p*f,this._y=h*p*u+l*c*f,this._z=h*c*f-l*p*u,this._w=h*c*u-l*p*f):"XZY"===o&&(this._x=l*c*u-h*p*f,this._y=h*p*u-l*c*f,this._z=h*c*f+l*p*u,this._w=h*c*u+l*p*f),!1!==e&&this.fire("change",this),this},e.prototype.setFromAxisAngle=function(t,e){var r=e/2,i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this.fire("change",this),this},e.prototype.setFromRotationMat=function(t){var e,r=t.elements,i=r[0],n=r[4],o=r[8],s=r[1],a=r[5],h=r[9],c=r[2],u=r[6],l=r[10],p=i+a+l;return p>0?(e=.5/Math.sqrt(p+1),this._w=.25/e,this._x=(u-h)*e,this._y=(o-c)*e,this._z=(s-n)*e):i>a&&i>l?(e=2*Math.sqrt(1+i-a-l),this._w=(u-h)/e,this._x=.25*e,this._y=(n+s)/e,this._z=(o+c)/e):a>l?(e=2*Math.sqrt(1+a-i-l),this._w=(o-c)/e,this._x=(n+s)/e,this._y=.25*e,this._z=(h+u)/e):(e=2*Math.sqrt(1+l-i-a),this._w=(s-n)/e,this._x=(o+c)/e,this._y=(h+u)/e,this._z=.25*e),this.fire("change",this),this},e.prototype.setFromUnitVecs=function(t,e){var r=t.dot(e)+1;return r<1e-6?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=r),this.normalize()},e.prototype.angleTo=function(t){return 2*Math.acos(Math.abs(o.clamp(this.dot(t),-1,1)))},e.prototype.rotateTowards=function(t,e){var r=this.angleTo(t);if(0===r)return this;var i=Math.min(1,e/r);return this.slerp(t,i),this},e.prototype.inverse=function(){return this.conjugate()},e.prototype.invert=function(){return this.conjugate()},e.prototype.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.fire("change",this),this},e.prototype.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},e.prototype.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},e.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},e.prototype.normalize=function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.fire("change",this),this},e.prototype.multiply=function(t,e){return void 0!==e?this.multiplyQuats(t,e):this.multiplyQuats(this,t)},e.prototype.premultiply=function(t){return this.multiplyQuats(t,this)},e.prototype.multiplyQuats=function(t,e){var r=t._x,i=t._y,n=t._z,o=t._w,s=e._x,a=e._y,h=e._z,c=e._w;return this._x=r*c+o*s+i*h-n*a,this._y=i*c+o*a+n*s-r*h,this._z=n*c+o*h+r*a-i*s,this._w=o*c-r*s-i*a-n*h,this.fire("change",this),this},e.prototype.slerp=function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var r=this._x,i=this._y,n=this._z,o=this._w,s=o*t._w+r*t._x+i*t._y+n*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=o,this._x=r,this._y=i,this._z=n,this;var a=1-s*s;if(a<=Number.EPSILON){var h=1-e;return this._w=h*o+e*this._w,this._x=h*r+e*this._x,this._y=h*i+e*this._y,this._z=h*n+e*this._z,this.normalize(),this.fire("change",this),this}var c=Math.sqrt(a),u=Math.atan2(c,s),l=Math.sin((1-e)*u)/c,p=Math.sin(e*u)/c;return this._w=o*l+this._w*p,this._x=r*l+this._x*p,this._y=i*l+this._y*p,this._z=n*l+this._z*p,this.fire("change",this),this},e.prototype.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},e.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.fire("change",this),this},e.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},e}(r(364).EventHandler);e.Quat=s,e.quat=function(t,e,r,i){return new s(t,e,r,i)}},366:function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.segment=e.Segment=void 0;var o=r(360),s=function(t){function e(r,i){void 0===r&&(r=o.v3()),void 0===i&&(i=o.v3());var n=t.call(this)||this;return Object.setPrototypeOf(n,e.prototype),n.push(o.v3().copy(r),o.v3().copy(i)),n.center=o.v3().addVecs(r,i).multiplyScalar(.5),n.extentDirection=o.v3().subVecs(i,r),n.extentSqr=n.extentDirection.lengthSq(),n.extent=Math.sqrt(n.extentSqr),n.direction=o.v3().copy(n.extentDirection).normalize(),n}return n(e,t),e.prototype.set=function(t,e){this[0].copy(t),this[1].copy(e),this.change()},e.prototype.change=function(){this.center.addVecs(this[1],this[0]).multiplyScalar(.5),this.extentDirection.subVecs(this[1],this[0]),this.extentSqr=this.extentDirection.lengthSq(),this.extent=Math.sqrt(this.extentSqr),this.direction.copy(this.extentDirection.clone()).normalize()},Object.defineProperty(e.prototype,"p0",{get:function(){return this[0]},set:function(t){this[0].copy(t),this.change()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"p1",{get:function(){return this[1]},set:function(t){this[1].copy(t),this.change()},enumerable:!1,configurable:!0}),e.prototype.offset=function(t,e){void 0===e&&(e=o.Vec3.UnitY);var r=this.direction.clone().applyAxisAngle(e,Math.PI/2);r.normalize().multiplyScalar(t),this.p0.add(r),this.p1.add(r)},e.prototype.distanceSegment=function(t){var e={parameters:[],closests:[]};function r(t,e,r){var i;return e<0?r>0?(i=-e/t)>1&&(i=.5):i=1:i=0,i}var i=this.p1.clone().sub(this.p0),n=t.p1.clone().sub(t.p0),o=this.p0.clone().sub(t.p0),s=i.dot(i),a=i.dot(n),h=n.dot(n),c=i.dot(o),u=n.dot(o),l=c,p=l+s,f=l-a,y=p-a,d=-u,_=d-a,v=d+h,m=_+h;if(s>0&&h>0){var g=[];g[0]=r(s,l,p),g[1]=r(s,f,y);for(var x=[],b=0;b<2;++b)g[b]<=0?x[b]=-1:g[b]>=1?x[b]=1:x[b]=0;if(-1==x[0]&&-1==x[1])e.parameters[0]=0,e.parameters[1]=r(h,d,v);else if(1==x[0]&&1==x[1])e.parameters[0]=1,e.parameters[1]=r(h,_,m);else{for(var w=[],M=new Array(2),z=0;z<M.length;z++)M[z]=new Array(2);!function(t,e,r,i){e[0]<0?(r[0]=0,i[0][0]=0,i[0][1]=l/a,(i[0][1]<0||i[0][1]>1)&&(i[0][1]=.5),0==e[1]?(r[1]=3,i[1][0]=t[1],i[1][1]=1):(r[1]=1,i[1][0]=1,i[1][1]=p/a,(i[1][1]<0||i[1][1]>1)&&(i[1][1]=.5))):0==e[0]?(r[0]=2,i[0][0]=t[0],i[0][1]=0,e[1]<0?(r[1]=0,i[1][0]=0,i[1][1]=l/a,(i[1][1]<0||i[1][1]>1)&&(i[1][1]=.5)):0==e[1]?(r[1]=3,i[1][0]=t[1],i[1][1]=1):(r[1]=1,i[1][0]=1,i[1][1]=p/a,(i[1][1]<0||i[1][1]>1)&&(i[1][1]=.5))):(r[0]=1,i[0][0]=1,i[0][1]=p/a,(i[0][1]<0||i[0][1]>1)&&(i[0][1]=.5),0==e[1]?(r[1]=3,i[1][0]=t[1],i[1][1]=1):(r[1]=0,i[1][0]=0,i[1][1]=l/a,(i[1][1]<0||i[1][1]>1)&&(i[1][1]=.5)))}(g,x,w,M),function(t,e,i){var n=e[1][1]-e[0][1],o=n*(-a*e[0][0]+h*e[0][1]-u);if(o>=0)0==t[0]?(i[0]=0,i[1]=r(h,d,v)):1==t[0]?(i[0]=1,i[1]=r(h,_,m)):(i[0]=e[0][0],i[1]=e[0][1]);else{var s=n*(-a*e[1][0]+h*e[1][1]-u);if(s<=0)0==t[1]?(i[0]=0,i[1]=r(h,d,v)):1==t[1]?(i[0]=1,i[1]=r(h,_,m)):(i[0]=e[1][0],i[1]=e[1][1]);else{var c=Math.min(Math.max(o/(o-s),0),1),l=1-c;i[0]=l*e[0][0]+c*e[1][0],i[1]=l*e[0][1]+c*e[1][1]}}}(w,M,e.parameters)}}else s>0?(e.parameters[0]=r(s,l,p),e.parameters[1]=0):h>0?(e.parameters[0]=0,e.parameters[1]=r(h,d,v)):(e.parameters[0]=0,e.parameters[1]=0);e.closests[0]=this.p0.clone().multiplyScalar(1-e.parameters[0]).add(this.p1.clone().multiplyScalar(e.parameters[0])),e.closests[1]=t.p0.clone().multiplyScalar(1-e.parameters[1]).add(t.p1.clone().multiplyScalar(e.parameters[1]));var P=e.closests[0].clone().sub(e.closests[1]);return e.distanceSqr=P.dot(P),e.distance=Math.sqrt(e.distanceSqr),e},e.prototype.distancePlane=function(t){t.orientationPoint(this.p0)},e.prototype.intersectSegment=function(t){},e}(Array);e.Segment=s,e.segment=function(t,e){return new s(t,e)}},367:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.line=e.Line=void 0;var i=r(360),n=r(366),o=r(361),s=(new i.Vec3,function(){function t(t,e){void 0===t&&(t=i.v3()),void 0===e&&(e=i.v3()),this.origin=t,this.end=e,this.direction=this.end.clone().sub(this.origin).normalize()}return t.prototype.set=function(t,e){return this.origin.copy(t),this.end.copy(e),this},t.prototype.distancePoint=function(t){return t.distanceLine(this)},t.prototype.distanceSegment=function(t){var e,r,i={parameters:[],closests:[]},n=t.center,o=t.direction,s=.5*t.extent,a=this.origin.clone().sub(n),h=-this.direction.dot(o),c=a.dot(this.direction);if(Math.abs(h)<1){var u=1-h*h,l=s*u,p=-a.dot(o);(r=h*c-p)>=-l?r<=l?(e=(h*p-c)/u,r/=u):e=-(h*(r=s)+c):e=-(h*(r=-s)+c)}else r=0,e=-c;return i.parameters[0]=e,i.parameters[1]=r,i.closests[0]=this.direction.clone().multiplyScalar(e).add(this.origin),i.closests[1]=o.clone().multiplyScalar(r).add(n),a=i.closests[0].clone().sub(i.closests[1]),i.distanceSqr=a.dot(a),i.distance=Math.sqrt(i.distanceSqr),i},t.prototype.distanceLine=function(t){var e,r,i={parameters:[],closests:[]},n=this.origin.clone().sub(t.origin),o=-this.direction.dot(t.direction),s=n.dot(this.direction);if(Math.abs(o)<1){var a=1-o*o,h=-n.dot(t.direction);e=(o*h-s)/a,r=(o*s-h)/a}else e=-s,r=0;return i.parameters[0]=e,i.parameters[1]=r,i.closests[0]=this.direction.clone().multiplyScalar(e).add(this.origin),i.closests[1]=t.direction.clone().multiplyScalar(r).add(t.origin),n=i.closests[0].clone().sub(i.closests[1]),i.distanceSqr=n.dot(n),i.distance=Math.sqrt(i.distanceSqr),i},t.prototype.distanceRay=function(t){var e,r,i={parameters:[],closests:[]},n=this.origin.clone().sub(t.origin),o=-this.direction.dot(t.direction),s=n.dot(this.direction);if(Math.abs(o)<1){var a=-n.dot(t.direction);if((r=o*s-a)>=0){var h=1-o*o;e=(o*a-s)/h,r/=h}else e=-s,r=0}else e=-s,r=0;return i.parameters[0]=e,i.parameters[1]=r,i.closests[0]=this.direction.clone().multiplyScalar(e).add(this.origin),i.closests[1]=t.direction.clone().multiplyScalar(r).add(t.origin),n=i.closests[0].clone().sub(i.closests[1]),i.distanceSqr=n.dot(n),i.distance=Math.sqrt(i.distanceSqr),i},t.prototype.distanceTriangle=function(t){var e,r,s,a={closests:[],parameters:[],triangleParameters:[]},h=t.p1.clone().sub(t.p0),c=t.p2.clone().sub(t.p0),u=h.clone().cross(c).normalize().dot(this.direction);if(Math.abs(u)>=o.delta4){var l=this.origin.clone().sub(t.p0),p=new Array(3);p[0]=this.direction,r=p,void 0===s&&(s=!1),1===(e=1)&&(Math.abs(r[0][0])>Math.abs(r[0][1])?r[1]=i.v3(-r[0].z,0,+r[0].x):r[1]=i.v3(0,+r[0].z,-r[0].y),e=2),2==e&&(r[2]=r[0].clone().cross(r[1]),function(t,e,r){if(void 0===r&&(r=!1),e&&1<=t&&t<=3){var i=e[0].length();e[0].normalize();for(var n=1;n<t;++n){for(var o=0;o<n;++o){var s=e[n].dot(e[o]);e[n].sub(e[o].clone().multiplyScalar(s))}var a=e[n].length();e[n].normalize(),a<i&&(i=a)}return i}}(3,r,s));var f=p[1].dot(h),y=p[1].dot(c),d=p[1].dot(l),_=p[2].dot(h),v=p[2].dot(c),m=p[2].dot(l),g=1/(f*v-y*_),x=(v*d-y*m)*g,b=(f*m-_*d)*g,w=1-x-b;if(w>=0&&x>=0&&b>=0){var M=this.direction.dot(h),z=this.direction.dot(c),P=this.direction.dot(l);return a.lineParameter=x*M+b*z-P,a.triangleParameters[0]=w,a.triangleParameters[1]=x,a.triangleParameters[2]=b,a.closests[0]=this.direction.clone().multiplyScalar(a.lineParameter).add(this.origin),a.closests[1]=h.multiplyScalar(x).add(c.multiplyScalar(b)).add(t.p0),a.distance=0,a.distanceSqr=0,a}}a.distance=1/0,a.distanceSqr=1/0;for(var A=2,S=0;S<3;A=S++){t[A].clone().add(t[S]).multiplyScalar(.5);var O=t[S].clone().sub(t[A]),V=.5*O.length();O.normalize();var E=new n.Segment(t[A],t[S]),B=this.distanceSegment(E);B.distanceSqr<a.distanceSqr&&(a.distanceSqr=B.distanceSqr,a.distance=B.distance,a.lineParameter=B.parameters[0],a.triangleParameters[A]=.5*(1-B.parameters[0]/V),a.triangleParameters[S]=1-a.triangleParameters[A],a.triangleParameters[3-A-S]=0,a.closests[0]=B.closests[0],a.closests[1]=B.closests[1])}return a},t.prototype.distancePolyline=function(t){for(var e=t._array||t,r=null,i=-1,s=0;s<e.length-1;s++){var a=new n.Segment(e[s],e[s+1]),h=this.distanceSegment(a);if((!r||r.distance<h.distance)&&(r=h),r.distance<o.delta4){i=s;break}}return{distance:null==r?void 0:r.distance,distanceSqr:null==r?void 0:r.distanceSqr,parameters:null==r?void 0:r.parameters,closests:null==r?void 0:r.closests,segmentIndex:i}},t.prototype.intersectPlane=function(t,e){e||(e=new i.Vec3);var r=this.direction,n=t.normal.dot(r);if(0===n)return 0===this.distancePoint(this.origin).distance?e.copy(this.origin):void 0;var o=-(this.origin.dot(t.normal)-t.w)/n;return o<0||o>1?void 0:e.copy(r).multiplyScalar(o).add(this.origin)},t}());e.Line=s,e.line=function(t,e){return new s(t,e)}},372:function(t,e,r){"use strict";r(159),Object.defineProperty(e,"__esModule",{value:!0}),e.unique=e.classify=e.flat=e.forall=void 0,Array.prototype.get=function(t){return t<0&&(t=this.length+t),this[t]},Array.prototype.last=function(){return this.get(-1)},e.forall=function t(e,r){for(var i=0;i<e.length;i++){var n=e[i];r(n,i,e),Array.isArray(n)&&t(n,r)}},e.flat=function t(e){return e.flat?e.flat(1/0):e.reduce((function(e,r){return e.concat(Array.isArray(r)?t(r):r)}))},e.classify=function(t,e){for(var r=[],i=0;i<t.length;i++)for(var n=0;n<r.length;n++)e(t[i],r[n][0],r[n])?r[n].push(t[i]):r.push([t[i]]);return r},e.unique=function(t,e,r){if(r){t.sort(r);for(var i=0;i<t.length;i++)for(var n=i+1;n<t.length&&!0===e(t[i],t[n]);n++)t.splice(n,1),n--;return t}for(i=0;i<t.length;i++)for(n=i+1;n<t.length;n++)!0===e(t[i],t[n])&&(t.splice(n,1),n--);return t}},373:function(t,e,r){"use strict";r(158);var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.v2=e.Vec2=void 0;var o=function(t){function e(e,r){void 0===e&&(e=0),void 0===r&&(r=0);var i=t.call(this)||this;return i._x=e,i._y=r,i.isVec2=!0,i}return n(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.fire("change","x",this._x,t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.fire("change","y",this._y,t))},enumerable:!1,configurable:!0}),e.isVec2=function(t){return!isNaN(t.x)&&!isNaN(t.y)&&isNaN(t.z)&&isNaN(t.w)},Object.defineProperty(e.prototype,"width",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UnitX",{get:function(){return new e(1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UnitY",{get:function(){return new e(0,1)},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e){return this._x=t,this._y=e,this},e.prototype.setScalar=function(t){return this._x=t,this._y=t,this},e.prototype.setX=function(t){return this._x=t,this},e.prototype.setY=function(t){return this._y=t,this},e.prototype.setComponent=function(t,e){switch(t){case 0:this._x=e;break;case 1:this._y=e;break;default:throw new Error("index is out of range: "+t)}return this},e.prototype.getComponent=function(t){switch(t){case 0:return this._x;case 1:return this._y;default:throw new Error("index is out of range: "+t)}},e.prototype.clone=function(){return new e(this._x,this._y)},e.prototype.copy=function(t){return this._x=t.x,this._y=t.y,this},e.prototype.add=function(t,e){return void 0!==e?(console.warn("Vec2: .add() now only accepts one argument. Use .addVecs( a, b ) instead."),this.addVecs(t,e)):(this._x+=t.x,this._y+=t.y,this)},e.prototype.addScalar=function(t){return this._x+=t,this._y+=t,this},e.prototype.addVecs=function(t,e){return this._x=t.x+e.x,this._y=t.y+e.y,this},e.prototype.addScaledVec=function(t,e){return this._x+=t.x*e,this._y+=t.y*e,this},e.prototype.sub=function(t,e){return void 0!==e?(console.warn("Vec2: .sub() now only accepts one argument. Use .subVecs( a, b ) instead."),this.subVecs(t,e)):(this._x-=t.x,this._y-=t.y,this)},e.prototype.subScalar=function(t){return this._x-=t,this._y-=t,this},e.prototype.subVecs=function(t,e){return this._x=t.x-e.x,this._y=t.y-e.y,this},e.prototype.multiply=function(t){return this._x*=t.x,this._y*=t.y,this},e.prototype.multiplyScalar=function(t){return this._x*=t,this._y*=t,this},e.prototype.divide=function(t){return this._x/=t.x,this._y/=t.y,this},e.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},e.prototype.applyMat3=function(t){var e=this._x,r=this._y,i=t.elements;return this._x=i[0]*e+i[3]*r+i[6],this._y=i[1]*e+i[4]*r+i[7],this},e.prototype.min=function(t){return this._x=Math.min(this._x,t.x),this._y=Math.min(this._y,t.y),this},e.prototype.max=function(t){return this._x=Math.max(this._x,t.x),this._y=Math.max(this._y,t.y),this},e.prototype.clamp=function(t,e){return this._x=Math.max(t.x,Math.min(e.x,this._x)),this._y=Math.max(t.y,Math.min(e.y,this._y)),this},e.prototype.clampScalar=function(t,e){return this._x=Math.max(t,Math.min(e,this._x)),this._y=Math.max(t,Math.min(e,this._y)),this},e.prototype.clampLength=function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},e.prototype.floor=function(){return this._x=Math.floor(this._x),this._y=Math.floor(this._y),this},e.prototype.ceil=function(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this},e.prototype.round=function(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this},e.prototype.roundToZero=function(){return this._x=this._x<0?Math.ceil(this._x):Math.floor(this._x),this._y=this._y<0?Math.ceil(this._y):Math.floor(this._y),this},e.prototype.negate=function(){return this._x=-this._x,this._y=-this._y,this},e.prototype.dot=function(t){return this._x*t.x+this._y*t.y},e.prototype.cross=function(t){return this._x*t.y-this._y*t.x},e.prototype.lengthSq=function(){return this._x*this._x+this._y*this._y},e.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y)},e.prototype.manhattanLength=function(){return Math.abs(this._x)+Math.abs(this._y)},e.prototype.normalize=function(){return this.divideScalar(this.length()||1)},e.prototype.angle=function(){var t=Math.atan2(this._y,this._x);return t<0&&(t+=2*Math.PI),t},e.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},e.prototype.distanceToSquared=function(t){var e=this._x-t.x,r=this._y-t.y;return e*e+r*r},e.prototype.manhattanDistanceTo=function(t){return Math.abs(this._x-t.x)+Math.abs(this._y-t.y)},e.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},e.prototype.lerp=function(t,e){return this._x+=(t.x-this._x)*e,this._y+=(t.y-this._y)*e,this},e.prototype.lerpVecs=function(t,e,r){return this.subVecs(e,t).multiplyScalar(r).add(t)},e.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},e.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this},e.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t},e.prototype.fromBufferAttribute=function(t,e,r){return void 0!==r&&console.warn("Vec2: offset has been removed from .fromBufferAttribute()."),this._x=t.getX(e),this._y=t.getY(e),this},e.prototype.rotateAround=function(t,e){var r=Math.cos(e),i=Math.sin(e),n=this._x-t.x,o=this._y-t.y;return this._x=n*r-o*i+t.x,this._y=n*i+o*r+t.y,this},e}(r(364).EventHandler);e.Vec2=o,e.v2=function(){return new o}},374:function(t,e,r){"use strict";var i=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,n++)i[n]=o[s];return i};Object.defineProperty(e,"__esModule",{value:!0});var n=r(402),o=r(382),s=r(373),a=r(360),h=r(376),c=r(361),u=function(t,e){if(t.length%e!=0)throw"向量组件数量不一样"},l=function(){function t(){}return t.uniqueNeighborVecs=function(t,e){void 0===e&&(e=c.delta4);for(var r=0;r<t.length-1;r++){t[r].distanceTo(t[r+1])<e&&t.splice(r,1)}return t},t.uniqueNeighbor=function(t,e,r){void 0===e&&(e=3),void 0===r&&(r=c.delta4);for(var i=0;i<t.length;i+=e)for(var n=i+3;n<t.length;){for(var o=0,s=0;s<e;s++)o+=(t[i+s]-t[n+s])*(t[i+s]-t[n+s]);if(!(Math.sqrt(o)<r))break;t.splice(n,e)}return t},t.unique=function(t,e){void 0===e&&(e=3);for(var r=0;r<t.length;r+=e)for(var i=r+3;i<t.length;){for(var n=0,o=0;o<e;o++)n+=(t[r+o]-t[i+o])*(t[r+o]-t[i+o]);Math.sqrt(n)<1e-5?t.splice(i,e):i+=e}return t},t.reverse=function(t,e){void 0===e&&(e=3),u(t,e);for(var r=t.length,i=0;i<r;i+=e)t.unshift.apply(t,t.splice(i,e));return t},t.dot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length%2!=0)throw"两个向量组件数量不一样";for(var r=t.length/2,i=0,n=0;n<r;n++)i+=t[n]*t[r+n];return i},t.distanceSq=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length%2!=0)throw"向量组件数量不一样";for(var r=t.length/2,i=0,n=0;n<r;n++){var o=t[n]-t[r+n];i+=o*o}return i},t.distance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Math.sqrt(this.distanceSq.apply(this,t))},t.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length%2!=0)throw"两个向量组件数量不一样";if(Array.isArray(t[0])&&Array.isArray(t[1])){for(var r=0;r<t[0].length;r++)t[0][r]+=t[1][r];return t[0]}t.length%2!=0&&console.error("VecArray:distanceSq  向量错误!!!");var i=t.length/2,n=[];for(r=0;r<i;r++)n[r]=n[i+r]+n[r];return n},t.sub=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(u(t,2),Array.isArray(t[0])&&Array.isArray(t[1])){for(var r=0;r<t[0].length;r++)t[0][r]-=t[1][r];return t[0]}t.length%2!=0&&console.error("VecArray:distanceSq  向量错误!!!");var i=t.length/2,n=[];for(r=0;r<i;r++)n[r]=n[r]-n[i+r];return n},t.mul=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(u(t,2),Array.isArray(t[0])&&Array.isArray(t[1])){for(var r=0;r<t[0].length;r++)t[0][r]*=t[1][r];return t[0]}t.length%2!=0&&console.error("VecArray:distanceSq  向量错误!!!");var i=t.length/2,n=[];for(r=0;r<i;r++)n[r]=n[r]*n[i+r];return n},t.getVecAt=function(t,e,r){return void 0===r&&(r=3),[t[3*e],t[3*e+1],t[3*e+2]]},t.insertAt=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t.splice.apply(t,i([e*t.length,0],t))},t.isCCW=function(t,e){void 0===e&&(e=3);var r=0;if(t instanceof o.Polyline||t instanceof n.Polygon)for(var i=0;i<t.length;i++){var h=t.get(i);r+=-.5*((c=t.get((i+1)%t.length)).y+h.y)*(c.x-h.x)}else if(Array.isArray(t)&&t.length>0)if(t[0]instanceof a.Vec3||t[0]instanceof s.Vec2)for(i=0;i<t.length;i++){var c;h=t[i];r+=-.5*((c=t[(i+1)%t.length]).y+h.y)*(c.x-h.x)}else if(!isNaN(t[0]))for(i=0;i<t.length;i+=e){var u=t[i],l=t[(i+1)%t.length],p=t[(i+3)%t.length];r+=-.5*(t[(i+4)%t.length]+l)*(p-u)}return r>0},t.verctorToNumbers=function(e,r){if(void 0===r&&(r="xyz"),!(e instanceof Array))return console.error("传入参数必须是数组"),[];var i=[];if(void 0!==e[0].x&&void 0!==e[0].y&&void 0!==e[0].z&&void 0!==e[0].w){r=4!==r.length?"xyzw":r;for(var n=0;n<e.length;n++)for(var o=0;o<r.length;o++)i.push(e[n][r[o]])}if(void 0!==e[0].x&&void 0!==e[0].y&&void 0!==e[0].z){r=3!==r.length?"xyz":r;for(n=0;n<e.length;n++)for(o=0;o<r.length;o++)i.push(e[n][r[o]])}else if(void 0!==e[0].x&&void 0!==e[0].y){r=2!==r.length?"xy":r;for(n=0;n<e.length;n++)for(o=0;o<r.length;o++)i.push(e[n][r[o]])}else if(e[0]instanceof Array)for(n=0;n<e.length;n++)i=i.concat(t.verctorToNumbers(e[n]));else console.error("数组内部的元素不是向量");return i},t.vec=function(t){if(void 0===t&&(t=3),2===t)return new s.Vec2;if(3===t)return new a.Vec3;if(4===t)return new h.Vec4;throw"暂时不支持4维以上的矢量"},t.numbersToVecs=function(e,r){void 0===r&&(r=3);for(var i=[],n=e.length,o=0;o<n;o+=r){var s=t.vec(r);s.fromArray(e.slice(o,o+r)),i.push(s)}return i},t}();e.default=l},375:function(t,e,r){"use strict";r(368),r(369),r(370),r(371);var i=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,n++)i[n]=o[s];return i};Object.defineProperty(e,"__esModule",{value:!0}),e.trianglutionToGeometryBuffer=e.toGeoBuffer=e.triangListToBuffer=e.indexable=void 0;var n=r(360),o=r(372),s=r(407),a=r(386);function h(t,e,r){if(void 0===e&&(e={index:0}),void 0===r&&(r=!1),t instanceof Array)for(var i=0;i<t.length;i++)h(t[i],e);else t instanceof Object&&(void 0===t.index||r)&&(t.index=e.index++)}function c(t,e,r){var i=new s.BufferGeometry;return i.addAttribute("position",t,3),i.addAttribute("uv",r||new Float32Array(i.getAttribute("position").array.length/3*2),2),i.setIndex(e),i}e.indexable=h,e.triangListToBuffer=function(t,e){h(e);var r=[];return o.forall(e,(function(t){r.push(t.index)})),c(t,r)},e.toGeoBuffer=c,e.trianglutionToGeometryBuffer=function(t,e,r){void 0===e&&(e=[]),void 0===r&&(r={normal:n.Vec3.UnitZ});var s=a.triangulation(t,e,r),h=i(t,o.flat(e)),u=[];return h.forEach((function(t){u.push(t.x,t.z)})),c(h,s,u)}},376:function(t,e,r){"use strict";r(158);var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.v4=e.Vec4=void 0;var o=function(t){function e(e,r,i,n){void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=1);var o=t.call(this)||this;return o._x=e,o._y=r,o._z=i,o._w=n,o.isVec4=!0,o}return n(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.fire("change","x",this._x,t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.fire("change","y",this._y,t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this.fire("change","z",this._z,t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"w",{get:function(){return this._w},set:function(t){this._w!==t&&(this._w=t,this.fire("change","w",this._w,t))},enumerable:!1,configurable:!0}),e.isVec4=function(t){return!(isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||isNaN(t.w))},Object.defineProperty(e.prototype,"width",{get:function(){return this._z},set:function(t){this._z=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._w},set:function(t){this._w=t},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._w=i,this},e.prototype.setScalar=function(t){return this._x=t,this._y=t,this._z=t,this._w=t,this},e.prototype.setX=function(t){return this._x=t,this},e.prototype.setY=function(t){return this._y=t,this},e.prototype.setZ=function(t){return this._z=t,this},e.prototype.setW=function(t){return this._w=t,this},e.prototype.setComponent=function(t,e){switch(t){case 0:this._x=e;break;case 1:this._y=e;break;case 2:this._z=e;break;case 3:this._w=e;break;default:throw new Error("index is out of range: "+t)}return this},e.prototype.getComponent=function(t){switch(t){case 0:return this._x;case 1:return this._y;case 2:return this._z;case 3:return this._w;default:throw new Error("index is out of range: "+t)}},e.prototype.clone=function(){return new e(this._x,this._y,this._z,this._w)},e.prototype.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=void 0!==t.w?t.w:1,this},e.prototype.add=function(t,e){return void 0!==e?(console.warn("Vec4: .add() now only accepts one argument. Use .addVecs( a, b ) instead."),this.addVecs(t,e)):(this._x+=t.x,this._y+=t.y,this._z+=t.z,this._w+=t.w,this)},e.prototype.addScalar=function(t){return this._x+=t,this._y+=t,this._z+=t,this._w+=t,this},e.prototype.addVecs=function(t,e){return this._x=t.x+e.x,this._y=t.y+e.y,this._z=t.z+e.z,this._w=t.w+e.w,this},e.prototype.addScaledVec=function(t,e){return this._x+=t.x*e,this._y+=t.y*e,this._z+=t.z*e,this._w+=t.w*e,this},e.prototype.sub=function(t,e){return void 0!==e?this.subVecs(t,e):(this._x-=t.x,this._y-=t.y,this._z-=t.z,this._w-=t.w,this)},e.prototype.subScalar=function(t){return this._x-=t,this._y-=t,this._z-=t,this._w-=t,this},e.prototype.subVecs=function(t,e){return this._x=t.x-e.x,this._y=t.y-e.y,this._z=t.z-e.z,this._w=t.w-e.w,this},e.prototype.multiplyScalar=function(t){return this._x*=t,this._y*=t,this._z*=t,this._w*=t,this},e.prototype.applyMat4=function(t){var e=this._x,r=this._y,i=this._z,n=this._w,o=t.elements;return this._x=o[0]*e+o[4]*r+o[8]*i+o[12]*n,this._y=o[1]*e+o[5]*r+o[9]*i+o[13]*n,this._z=o[2]*e+o[6]*r+o[10]*i+o[14]*n,this._w=o[3]*e+o[7]*r+o[11]*i+o[15]*n,this},e.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},e.prototype.setAxisAngleFromQuat=function(t){this._w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this._x=1,this._y=0,this._z=0):(this._x=t.x/e,this._y=t.y/e,this._z=t.z/e),this},e.prototype.setAxisAngleFromRotationMat=function(t){var e,r,i,n,o=t.elements,s=o[0],a=o[4],h=o[8],c=o[1],u=o[5],l=o[9],p=o[2],f=o[6],y=o[10];if(Math.abs(a-c)<.01&&Math.abs(h-p)<.01&&Math.abs(l-f)<.01){if(Math.abs(a+c)<.1&&Math.abs(h+p)<.1&&Math.abs(l+f)<.1&&Math.abs(s+u+y-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var d=(s+1)/2,_=(u+1)/2,v=(y+1)/2,m=(a+c)/4,g=(h+p)/4,x=(l+f)/4;return d>_&&d>v?d<.01?(r=0,i=.707106781,n=.707106781):(i=m/(r=Math.sqrt(d)),n=g/r):_>v?_<.01?(r=.707106781,i=0,n=.707106781):(r=m/(i=Math.sqrt(_)),n=x/i):v<.01?(r=.707106781,i=.707106781,n=0):(r=g/(n=Math.sqrt(v)),i=x/n),this.set(r,i,n,e),this}var b=Math.sqrt((f-l)*(f-l)+(h-p)*(h-p)+(c-a)*(c-a));return Math.abs(b)<.001&&(b=1),this._x=(f-l)/b,this._y=(h-p)/b,this._z=(c-a)/b,this._w=Math.acos((s+u+y-1)/2),this},e.prototype.min=function(t){return this._x=Math.min(this._x,t.x),this._y=Math.min(this._y,t.y),this._z=Math.min(this._z,t.z),this._w=Math.min(this._w,t.w),this},e.prototype.max=function(t){return this._x=Math.max(this._x,t.x),this._y=Math.max(this._y,t.y),this._z=Math.max(this._z,t.z),this._w=Math.max(this._w,t.w),this},e.prototype.clamp=function(t,e){return this._x=Math.max(t.x,Math.min(e.x,this._x)),this._y=Math.max(t.y,Math.min(e.y,this._y)),this._z=Math.max(t.z,Math.min(e.z,this._z)),this._w=Math.max(t.w,Math.min(e.w,this._w)),this},e.prototype.clampScalar=function(t,e){return this._x=Math.max(t,Math.min(e,this._x)),this._y=Math.max(t,Math.min(e,this._y)),this._z=Math.max(t,Math.min(e,this._z)),this._w=Math.max(t,Math.min(e,this._w)),this},e.prototype.clampLength=function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},e.prototype.floor=function(){return this._x=Math.floor(this._x),this._y=Math.floor(this._y),this._z=Math.floor(this._z),this._w=Math.floor(this._w),this},e.prototype.ceil=function(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this._z=Math.ceil(this._z),this._w=Math.ceil(this._w),this},e.prototype.round=function(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this._z=Math.round(this._z),this._w=Math.round(this._w),this},e.prototype.roundToZero=function(){return this._x=this._x<0?Math.ceil(this._x):Math.floor(this._x),this._y=this._y<0?Math.ceil(this._y):Math.floor(this._y),this._z=this._z<0?Math.ceil(this._z):Math.floor(this._z),this._w=this._w<0?Math.ceil(this._w):Math.floor(this._w),this},e.prototype.negate=function(){return this._x=-this._x,this._y=-this._y,this._z=-this._z,this._w=-this._w,this},e.prototype.dot=function(t){return this._x*t.x+this._y*t.y+this._z*t.z+this._w*t.w},e.prototype.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},e.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},e.prototype.manhattanLength=function(){return Math.abs(this._x)+Math.abs(this._y)+Math.abs(this._z)+Math.abs(this._w)},e.prototype.normalize=function(){return this.divideScalar(this.length()||1)},e.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},e.prototype.lerp=function(t,e){return this._x+=(t.x-this._x)*e,this._y+=(t.y-this._y)*e,this._z+=(t.z-this._z)*e,this._w+=(t.w-this._w)*e,this},e.prototype.lerpVecs=function(t,e,r){return this.subVecs(e,t).multiplyScalar(r).add(t)},e.prototype.equals=function(t){return t.x===this._x&&t.y===this._y&&t.z===this._z&&t.w===this._w},e.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this},e.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},e.prototype.fromBufferAttribute=function(t,e,r){return void 0!==r&&console.warn("Vec4: offset has been removed from .fromBufferAttribute()."),this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},e}(r(364).EventHandler);e.Vec4=o,e.v4=function(t,e,r,i){return new o(t,e,r,i)}},377:function(t,e,r){"use strict";r(158),Object.defineProperty(e,"__esModule",{value:!0}),e.m4=e.Mat4=void 0;var i=r(360),n=function(){function t(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.isMat4=!0,arguments.length>0&&console.error(" Mat4: the constructor no longer reads arguments. use .set() instead.")}return t.prototype.set=function(t,e,r,i,n,o,s,a,h,c,u,l,p,f,y,d){var _=this.elements;return _[0]=t,_[4]=e,_[8]=r,_[12]=i,_[1]=n,_[5]=o,_[9]=s,_[13]=a,_[2]=h,_[6]=c,_[10]=u,_[14]=l,_[3]=p,_[7]=f,_[11]=y,_[15]=d,this},Object.defineProperty(t,"Identity",{get:function(){return new t},enumerable:!1,configurable:!0}),t.prototype.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},t.prototype.clone=function(){return(new t).fromArray(this.elements)},t.prototype.copy=function(t){var e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this},t.prototype.copyPosition=function(t){var e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this},t.prototype.extractBasis=function(t,e,r){return t.setFromMatColumn(this,0),e.setFromMatColumn(this,1),r.setFromMatColumn(this,2),this},t.prototype.makeBasis=function(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this},t.prototype.extractRotation=function(t){var e=this.elements,r=t.elements,i=1/o.setFromMatColumn(t,0).length(),n=1/o.setFromMatColumn(t,1).length(),s=1/o.setFromMatColumn(t,2).length();return e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e[3]=0,e[4]=r[4]*n,e[5]=r[5]*n,e[6]=r[6]*n,e[7]=0,e[8]=r[8]*s,e[9]=r[9]*s,e[10]=r[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},t.prototype.makeRotationFromEuler=function(t){t&&t.isEuler||console.error(" Mat4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vec3 and order.");var e=this.elements,r=t.x,i=t.y,n=t.z,o=Math.cos(r),s=Math.sin(r),a=Math.cos(i),h=Math.sin(i),c=Math.cos(n),u=Math.sin(n);if("XYZ"===t.order){var l=o*c,p=o*u,f=s*c,y=s*u;e[0]=a*c,e[4]=-a*u,e[8]=h,e[1]=p+f*h,e[5]=l-y*h,e[9]=-s*a,e[2]=y-l*h,e[6]=f+p*h,e[10]=o*a}else if("YXZ"===t.order){var d=a*c,_=a*u,v=h*c,m=h*u;e[0]=d+m*s,e[4]=v*s-_,e[8]=o*h,e[1]=o*u,e[5]=o*c,e[9]=-s,e[2]=_*s-v,e[6]=m+d*s,e[10]=o*a}else if("ZXY"===t.order){d=a*c,_=a*u,v=h*c,m=h*u;e[0]=d-m*s,e[4]=-o*u,e[8]=v+_*s,e[1]=_+v*s,e[5]=o*c,e[9]=m-d*s,e[2]=-o*h,e[6]=s,e[10]=o*a}else if("ZYX"===t.order){l=o*c,p=o*u,f=s*c,y=s*u;e[0]=a*c,e[4]=f*h-p,e[8]=l*h+y,e[1]=a*u,e[5]=y*h+l,e[9]=p*h-f,e[2]=-h,e[6]=s*a,e[10]=o*a}else if("YZX"===t.order){var g=o*a,x=o*h,b=s*a,w=s*h;e[0]=a*c,e[4]=w-g*u,e[8]=b*u+x,e[1]=u,e[5]=o*c,e[9]=-s*c,e[2]=-h*c,e[6]=x*u+b,e[10]=g-w*u}else if("XZY"===t.order){g=o*a,x=o*h,b=s*a,w=s*h;e[0]=a*c,e[4]=-u,e[8]=h*c,e[1]=g*u+w,e[5]=o*c,e[9]=x*u-b,e[2]=b*u-x,e[6]=s*c,e[10]=w*u+g}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},t.prototype.makeRotationFromQuat=function(t){return this.compose(a,t,h)},t.prototype.lookAt=function(t,e,r){var i=this.elements;return l.subVecs(t,e),0===l.lengthSq()&&(l.z=1),l.normalize(),c.crossVecs(r,l),0===c.lengthSq()&&(1===Math.abs(r.z)?l.x+=1e-4:l.z+=1e-4,l.normalize(),c.crossVecs(r,l)),c.normalize(),u.crossVecs(l,c),i[0]=c.x,i[4]=u.x,i[8]=l.x,i[1]=c.y,i[5]=u.y,i[9]=l.y,i[2]=c.z,i[6]=u.z,i[10]=l.z,this},t.prototype.multiply=function(t,e){return void 0!==e?this.multiplyMats(t,e):this.multiplyMats(this,t)},t.prototype.premultiply=function(t){return this.multiplyMats(t,this)},t.prototype.multiplyMats=function(t,e){var r=t.elements,i=e.elements,n=this.elements,o=r[0],s=r[4],a=r[8],h=r[12],c=r[1],u=r[5],l=r[9],p=r[13],f=r[2],y=r[6],d=r[10],_=r[14],v=r[3],m=r[7],g=r[11],x=r[15],b=i[0],w=i[4],M=i[8],z=i[12],P=i[1],A=i[5],S=i[9],O=i[13],V=i[2],E=i[6],B=i[10],j=i[14],k=i[3],N=i[7],q=i[11],T=i[15];return n[0]=o*b+s*P+a*V+h*k,n[4]=o*w+s*A+a*E+h*N,n[8]=o*M+s*S+a*B+h*q,n[12]=o*z+s*O+a*j+h*T,n[1]=c*b+u*P+l*V+p*k,n[5]=c*w+u*A+l*E+p*N,n[9]=c*M+u*S+l*B+p*q,n[13]=c*z+u*O+l*j+p*T,n[2]=f*b+y*P+d*V+_*k,n[6]=f*w+y*A+d*E+_*N,n[10]=f*M+y*S+d*B+_*q,n[14]=f*z+y*O+d*j+_*T,n[3]=v*b+m*P+g*V+x*k,n[7]=v*w+m*A+g*E+x*N,n[11]=v*M+m*S+g*B+x*q,n[15]=v*z+m*O+g*j+x*T,this},t.prototype.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},t.prototype.applyToBufferAttribute=function(t){for(var e=0,r=t.count;e<r;e++)o.x=t.getX(e),o.y=t.getY(e),o.z=t.getZ(e),o.applyMat4(this),t.setXYZ(e,o.x,o.y,o.z);return t},t.prototype.determinant=function(){var t=this.elements,e=t[0],r=t[4],i=t[8],n=t[12],o=t[1],s=t[5],a=t[9],h=t[13],c=t[2],u=t[6],l=t[10],p=t[14];return t[3]*(+n*a*u-i*h*u-n*s*l+r*h*l+i*s*p-r*a*p)+t[7]*(+e*a*p-e*h*l+n*o*l-i*o*p+i*h*c-n*a*c)+t[11]*(+e*h*u-e*s*p-n*o*u+r*o*p+n*s*c-r*h*c)+t[15]*(-i*s*c-e*a*u+e*s*l+i*o*u-r*o*l+r*a*c)},t.prototype.transpose=function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},t.prototype.setPosition=function(t,e,r){var i=this.elements;return t.isVec3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):void 0!==e&&void 0!==r?(i[12]=t,i[13]=e,i[14]=r):void 0!==t.x&&void 0!==t.y&&void 0!==t.z&&(i[12]=t.x,i[13]=t.y,i[14]=t.z),this},t.prototype.invert=function(){var t=this.elements,e=t[0],r=t[1],i=t[2],n=t[3],o=t[4],s=t[5],a=t[6],h=t[7],c=t[8],u=t[9],l=t[10],p=t[11],f=t[12],y=t[13],d=t[14],_=t[15],v=u*d*h-y*l*h+y*a*p-s*d*p-u*a*_+s*l*_,m=f*l*h-c*d*h-f*a*p+o*d*p+c*a*_-o*l*_,g=c*y*h-f*u*h+f*s*p-o*y*p-c*s*_+o*u*_,x=f*u*a-c*y*a-f*s*l+o*y*l+c*s*d-o*u*d,b=e*v+r*m+i*g+n*x;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var w=1/b;return t[0]=v*w,t[1]=(y*l*n-u*d*n-y*i*p+r*d*p+u*i*_-r*l*_)*w,t[2]=(s*d*n-y*a*n+y*i*h-r*d*h-s*i*_+r*a*_)*w,t[3]=(u*a*n-s*l*n-u*i*h+r*l*h+s*i*p-r*a*p)*w,t[4]=m*w,t[5]=(c*d*n-f*l*n+f*i*p-e*d*p-c*i*_+e*l*_)*w,t[6]=(f*a*n-o*d*n-f*i*h+e*d*h+o*i*_-e*a*_)*w,t[7]=(o*l*n-c*a*n+c*i*h-e*l*h-o*i*p+e*a*p)*w,t[8]=g*w,t[9]=(f*u*n-c*y*n-f*r*p+e*y*p+c*r*_-e*u*_)*w,t[10]=(o*y*n-f*s*n+f*r*h-e*y*h-o*r*_+e*s*_)*w,t[11]=(c*s*n-o*u*n-c*r*h+e*u*h+o*r*p-e*s*p)*w,t[12]=x*w,t[13]=(c*y*i-f*u*i+f*r*l-e*y*l-c*r*d+e*u*d)*w,t[14]=(f*s*i-o*y*i-f*r*a+e*y*a+o*r*d-e*s*d)*w,t[15]=(o*u*i-c*s*i+c*r*a-e*u*a-o*r*l+e*s*l)*w,this},t.prototype.getInverse=function(t,e){void 0===e&&(e=!0);var r=this.elements,i=t.elements,n=i[0],o=i[1],s=i[2],a=i[3],h=i[4],c=i[5],u=i[6],l=i[7],p=i[8],f=i[9],y=i[10],d=i[11],_=i[12],v=i[13],m=i[14],g=i[15],x=f*m*l-v*y*l+v*u*d-c*m*d-f*u*g+c*y*g,b=_*y*l-p*m*l-_*u*d+h*m*d+p*u*g-h*y*g,w=p*v*l-_*f*l+_*c*d-h*v*d-p*c*g+h*f*g,M=_*f*u-p*v*u-_*c*y+h*v*y+p*c*m-h*f*m,z=n*x+o*b+s*w+a*M;if(0===z){var P=" Mat4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(P);return console.warn(P),this.identity()}var A=1/z;return r[0]=x*A,r[1]=(v*y*a-f*m*a-v*s*d+o*m*d+f*s*g-o*y*g)*A,r[2]=(c*m*a-v*u*a+v*s*l-o*m*l-c*s*g+o*u*g)*A,r[3]=(f*u*a-c*y*a-f*s*l+o*y*l+c*s*d-o*u*d)*A,r[4]=b*A,r[5]=(p*m*a-_*y*a+_*s*d-n*m*d-p*s*g+n*y*g)*A,r[6]=(_*u*a-h*m*a-_*s*l+n*m*l+h*s*g-n*u*g)*A,r[7]=(h*y*a-p*u*a+p*s*l-n*y*l-h*s*d+n*u*d)*A,r[8]=w*A,r[9]=(_*f*a-p*v*a-_*o*d+n*v*d+p*o*g-n*f*g)*A,r[10]=(h*v*a-_*c*a+_*o*l-n*v*l-h*o*g+n*c*g)*A,r[11]=(p*c*a-h*f*a-p*o*l+n*f*l+h*o*d-n*c*d)*A,r[12]=M*A,r[13]=(p*v*s-_*f*s+_*o*y-n*v*y-p*o*m+n*f*m)*A,r[14]=(_*c*s-h*v*s-_*o*u+n*v*u+h*o*m-n*c*m)*A,r[15]=(h*f*s-p*c*s+p*o*u-n*f*u-h*o*y+n*c*y)*A,this},t.prototype.scale=function(t){var e=this.elements,r=t.x,i=t.y,n=t.z;return e[0]*=r,e[4]*=i,e[8]*=n,e[1]*=r,e[5]*=i,e[9]*=n,e[2]*=r,e[6]*=i,e[10]*=n,e[3]*=r,e[7]*=i,e[11]*=n,this},t.prototype.getMaxScaleOnAxis=function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,i))},t.prototype.makeTranslation=function(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},t.prototype.makeRotationX=function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this},t.prototype.makeRotationY=function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this},t.prototype.makeRotationZ=function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this},t.prototype.makeRotationAxis=function(t,e){var r=Math.cos(e),i=Math.sin(e),n=1-r,o=t.x,s=t.y,a=t.z,h=n*o,c=n*s;return this.set(h*o+r,h*s-i*a,h*a+i*s,0,h*s+i*a,c*s+r,c*a-i*o,0,h*a-i*s,c*a+i*o,n*a*a+r,0,0,0,0,1),this},t.prototype.makeScale=function(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},t.prototype.makeShear=function(t,e,r,i,n,o){return this.set(1,r,n,0,t,1,o,0,e,i,1,0,0,0,0,1),this},t.prototype.compose=function(t,e,r){var i=this.elements,n=e._x,o=e._y,s=e._z,a=e._w,h=n+n,c=o+o,u=s+s,l=n*h,p=n*c,f=n*u,y=o*c,d=o*u,_=s*u,v=a*h,m=a*c,g=a*u,x=r.x,b=r.y,w=r.z;return i[0]=(1-(y+_))*x,i[1]=(p+g)*x,i[2]=(f-m)*x,i[3]=0,i[4]=(p-g)*b,i[5]=(1-(l+_))*b,i[6]=(d+v)*b,i[7]=0,i[8]=(f+m)*w,i[9]=(d-v)*w,i[10]=(1-(l+y))*w,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this},t.prototype.decompose=function(t,e,r){var i=this.elements,n=o.set(i[0],i[1],i[2]).length(),a=o.set(i[4],i[5],i[6]).length(),h=o.set(i[8],i[9],i[10]).length();this.determinant()<0&&(n=-n),t.x=i[12],t.y=i[13],t.z=i[14],s.copy(this);var c=1/n,u=1/a,l=1/h;return s.elements[0]*=c,s.elements[1]*=c,s.elements[2]*=c,s.elements[4]*=u,s.elements[5]*=u,s.elements[6]*=u,s.elements[8]*=l,s.elements[9]*=l,s.elements[10]*=l,e.setFromRotationMat(s),r.x=n,r.y=a,r.z=h,this},t.prototype.makePerspective=function(t,e,r,i,n,o){void 0===o&&console.warn(" Mat4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements,a=2*n/(e-t),h=2*n/(r-i),c=(e+t)/(e-t),u=(r+i)/(r-i),l=-(o+n)/(o-n),p=-2*o*n/(o-n);return s[0]=a,s[4]=0,s[8]=c,s[12]=0,s[1]=0,s[5]=h,s[9]=u,s[13]=0,s[2]=0,s[6]=0,s[10]=l,s[14]=p,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},t.prototype.makeOrthographic=function(t,e,r,i,n,o){var s=this.elements,a=1/(e-t),h=1/(r-i),c=1/(o-n),u=(e+t)*a,l=(r+i)*h,p=(o+n)*c;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-u,s[1]=0,s[5]=2*h,s[9]=0,s[13]=-l,s[2]=0,s[6]=0,s[10]=-2*c,s[14]=-p,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},t.prototype.equals=function(t){for(var e=this.elements,r=t.elements,i=0;i<16;i++)if(e[i]!==r[i])return!1;return!0},t.prototype.fromArray=function(t,e){void 0===e&&(e=0);for(var r=0;r<16;r++)this.elements[r]=t[r+e];return this},t.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t},t}();e.Mat4=n;var o=i.v3(),s=p(),a=(p(),i.v3(0,0,0)),h=i.v3(1,1,1),c=i.v3(),u=i.v3(),l=i.v3();function p(){return new n}e.m4=p},378:function(t,e,r){"use strict";var i=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,n++)i[n]=o[s];return i};Object.defineProperty(e,"__esModule",{value:!0}),e.Plane=void 0;var n=r(360),o=r(361),s=r(437),a=r(375),h=function(){function t(t,e){void 0===t&&(t=n.Vec3.UnitZ),void 0===e&&(e=0),this.normal=t,this.w=e,this.origin=this.normal.clone().multiplyScalar(e)}return t.setFromPointNormal=function(e,r){var i=new t;return i.setFromPointNormal(e,r),i},t.prototype.setFromPointNormal=function(t,e){this.normal=e,this.w=-t.dot(e)},t.prototype.set=function(t,e){this.normal=t,this.w=e},t.prototype.setComponents=function(t,e,r,i){return this.normal.set(t,e,r),this.w=i,this},t.prototype.normalize=function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.w*=t,this},t.prototype.setFromThreePoint=function(t,e,r){this.normal=e.clone().sub(t).cross(r.clone().sub(t)).normalize(),this.w=-t.dot(this.normal)},t.prototype.negate=function(){this.w*=-1,this.normal.negate()},t.prototype.frontback=function(t){var e=this.normal.dot(t);return o.approximateEqual(e,0)?0:o.sign(this.normal.dot(t))},t.prototype.distancePoint=function(t){return this.normal.dot(t)+this.w},t.prototype.distanceRay=function(t){},t.prototype.distanceLine=function(t){},t.prototype.distanceSegment=function(t){},t.prototype.distancePlane=function(t){},t.prototype.intersectSegmentLw=function(t){var e=this.orientationPoint(t[0])|this.orientationPoint(t[0]);if(e===s.Orientation.Common)return t;if(e===s.Orientation.Intersect){var r=t[0].clone().sub(this.origin).dot(this.normal);return this.normal.clone().multiplyScalar(r).add(t[0])}return null},t.prototype.intersectLine=function(t,e){return t.intersectPlane(this,e)},t.prototype.splitSegment=function(t){var e={positive:[],negative:[],common:[],orientation:s.Orientation.None},r=this.orientationPoint(t[0]),i=this.orientationPoint(t[1]),n=r|i;if(e.orientation=n,r===s.Orientation.Positive?e.positive.push(t[0]):r===s.Orientation.Negative?e.negative.push(t[0]):e.common.push(t[0]),i===s.Orientation.Positive?e.positive.push(t[1]):i===s.Orientation.Negative?e.negative.push(t[1]):e.common.push(t[1]),n===s.Orientation.Intersect){var o=t[0].clone().sub(this.origin).dot(this.normal),a=this.normal.clone().multiplyScalar(o).add(t[0]);e.positive.push(a),e.negative.push(a),e.intersectPoint=a}return e},t.prototype.splitTriangle=function(t){for(var e,r,i,n={negative:[],positive:[],common:[],orientation:s.Orientation.None},o=this,a=t.map((function(t){return o.orientationPoint(t)})),h=0,c=0,u=0;u<t.length;u++){var l=a[u];l===s.Orientation.Positive?h++:l===s.Orientation.Negative?c++:0}var p=h>0,f=c>0,y=n.positive,d=n.negative;if(f&&!p)n.orientation=s.Orientation.Negative,(e=n.negative).push.apply(e,t);else if(!f&&p)n.orientation=s.Orientation.Positive,(r=n.positive).push.apply(r,t);else if(p&&f){n.orientation=s.Orientation.Intersect;for(var _=0;_<3;_++)if(a[_]||a[(_+1)%3]===s.Orientation.Intersect){a[_]===s.Orientation.Positive?d.push(t[_]):a[_]==s.Orientation.Negative?y.push(t[_]):(y.push(t[_]),d.push(t[_]),n.common.push(t[_]));var v=this.intersectSegmentLw([t[_],t[(_+1)%3]]);v&&(Array.isArray(v)||n.common.push(v))}}else n.orientation=s.Orientation.Common,(i=n.common).push.apply(i,t);return n},t.prototype.splitPolyVS=function(t){t=i(t),a.indexable(t);for(var e=this.orientationPoint(t[0]),r=0;r<t.length-1;r++){var n=t[r],o=this.orientationPoint(n);if(o===s.Orientation.Common||e!==s.Orientation.None&&e!==o){r,n.clone(),e=o;break}e=o}},t.prototype.orientationPoint=function(t){var e=this.normal.clone().dot(t)+this.w;return Math.abs(e)<o.delta4?s.Orientation.Intersect:e<0?s.Orientation.Negative:s.Orientation.Positive},t.splitGeometry=function(t,e){for(var r=e.index,i=e.position,n=0;n<r.length;n+=3){var o=3*r[3*n],s=3*r[3*n+1],a=3*r[3*n+2];c.set(i[o],i[o+1],i[o+2]),u.set(i[s],i[s+1],i[s+2]),l.set(i[a],i[a+1],i[a+2]);var h=t.splitTriangle(p);h.common.length,h.negative.length,h.positive.length}},t}();e.Plane=h;var c=new n.Vec3,u=new n.Vec3,l=new n.Vec3,p=[c,u,l]},381:function(t,e,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||i(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(r(372),e),n(r(373),e),n(r(360),e),n(r(376),e),n(r(401),e),n(r(377),e),n(r(365),e),n(r(361),e),n(r(436),e),n(r(374),e),n(r(363),e),n(r(450),e),n(r(383),e),n(r(451),e),n(r(375),e),n(r(408),e),n(r(452),e),n(r(405),e),n(r(453),e),n(r(367),e),n(r(403),e),n(r(378),e),n(r(454),e),n(r(382),e),n(r(402),e),n(r(455),e),n(r(366),e),n(r(456),e),n(r(457),e),n(r(385),e),n(r(411),e),n(r(412),e),n(r(364),e),n(r(458),e),n(r(409),e),n(r(407),e),n(r(375),e)},382:function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Polyline=void 0;var o=r(383),s=r(361),a=r(360),h=r(367),c=r(366),u=function(t){function e(e,r){void 0===r&&(r=a.Vec3.UnitY);var i=t.call(this,e)||this;return i.isPolyline=!0,i.normal=r,i.isCoPlanar=!0,i}return n(e,t),e.prototype.offset=function(t,r,i,n){void 0===r&&(r=a.Vec3.UnitY),void 0===i&&(i=o.EndType.Butt),void 0===n&&(n=o.JoinType.Miter);for(var h=[],u=function(e){var i=new c.Segment(l.get(e).clone(),l.get(e+1).clone()),n=i[1].clone().sub(i[0]).normalize().applyAxisAngle(r,Math.PI/2).multiplyScalar(t);i.forEach((function(t){return t.add(n)})),h.push(i)},l=this,p=0;p<this.length-1;p++)u(p);for(p=0;p<h.length-1;p++)for(var f=h[p],y=p+1;y<h.length;y++){var d=h[y],_=f.distanceSegment(d);_.distance<s.delta4&&(d[0].copy(_.closests[0]),f[1].copy(_.closests[0]))}var v=[];v.push(h[0].p0);for(p=0;p<h.length;p++){var m=h[p];v.push(m.p1)}return new e(v)},e.prototype.corner=function(t,r){void 0===r&&(r=this.normal);for(var i=new e,n=0;n<this.length-2;n++){var o=this.get(n),s=this.get(n+1),a=this.get(n+2);i.push(o);var c=o.distanceTo(s)<=2*t?o.clone().add(s).multiplyScalar(.5):o.clone().sub(s).normalize().multiplyScalar(t).add(s),u=a.distanceTo(s)<=2*t?a.clone().add(s).multiplyScalar(.5):a.clone().sub(s).normalize().multiplyScalar(t).add(s);i.push(c);var l=s.clone().sub(o).applyAxisAngle(r,Math.PI/2),p=s.clone().sub(o).applyAxisAngle(r,Math.PI/2);new h.Line(c,l.add(c)),new h.Line(u,p.add(u));i.push(u)}return i},e}(r(404).ArrayList);e.Polyline=u},383:function(t,e,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},n=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,n++)i[n]=o[s];return i},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.extrudeNext=e.EndType=e.JoinType=e.extrude_obsolete=e.extrude=e.linkSides=e.linkSide=void 0;var s=r(360),a=r(373),h=r(365),c=r(403),u=r(363),l=r(410),p=r(375),f=r(386),y=r(372),d=r(384),_=r(377),v=r(361),m=o(r(374)),g=r(449);function x(t){var e=(t=i({shapeClosed:!0,autoUV:!0},t)).side0,r=t.side1,n=t.shapeClosed;if(e.length!==r.length)throw"拉伸两边的点数量不一致  linkSide";if(e.length<2||r.length<2)return[];var o=e.length,s=n?e.length:e.length-1,a=[];if(e[0]instanceof Number)for(var h=0;h<s;h++){var c=e[h],u=e[(h+1)%o],l=r[h],p=r[(h+1)%o];a.push(c),a.push(u),a.push(p),a.push(c),a.push(p),a.push(l)}else if(d.isDefined(e[0].index))for(h=0;h<s;h++){c=e[h],u=e[(h+1)%o],l=r[h],p=r[(h+1)%o];a.push(c.index),a.push(u.index),a.push(p.index),a.push(c.index),a.push(p.index),a.push(l.index)}else for(h=0;h<s;h++){c=e[h],u=e[(h+1)%o],l=r[h],p=r[(h+1)%o];a.push(c),a.push(u),a.push(p),a.push(c),a.push(p),a.push(l)}if(t.holes0&&t.holes1)for(var f=t.holes0,y=t.holes1,_=0;_<f.length;_++){var v=x({side0:f[_],side1:y[_]});v.reverse(),a.push.apply(a,v)}return a}function b(t){(t=i({sealEnd:!0,sealStart:!0,shapeClosed:!0,pathClosed:!1,generateUV:!0,autoIndex:!0,axisPlane:f.AxisPlane.XY},t)).autoIndex&&(t.index=t.index||{index:0});var e=t.shapes,r=t.holes,o=!!(r&&r.length>0),s=t.pathClosed?e.length:e.length-1,a=[],h=t.index,l=[e];o&&l.push(r);var y=t.orgShape||e[0],d=t.orgHoles||r&&r[0];h&&p.indexable(l,h);for(var _=0;_<s;_++)r?a.push.apply(a,x({side0:e[_],side1:e[(_+1)%e.length],holes0:r[_],holes1:r[(_+1)%e.length],shapeClosed:t.shapeClosed})):a.push.apply(a,x({side0:e[_],side1:e[(_+1)%e.length],shapeClosed:t.shapeClosed}));if(t.sealStart){var v=u.clone(e[0]);if(l.push(v),r&&r[0]){var g=u.clone(r[0]);l.push(g)}var b=f.triangulation(y,d,{feature:f.AxisPlane.XYZ});h&&(b.forEach((function(t,e){b[e]=t+(null==h?void 0:h.index)})),h.index+=v.length,r&&r[0]&&g.forEach((function(t){h.index+=t.length}))),a.push.apply(a,b.reverse())}if(t.sealEnd){var w=u.clone(e[e.length-1]);if(l.push(w),r&&r[0]){var M=u.clone(u.clone(r[r.length-1]));l.push(M)}var z=f.triangulation(y,d,{feature:f.AxisPlane.XYZ});h&&(z.forEach((function(t,e){z[e]=t+(null==h?void 0:h.index)})),h.index+=w.length,r&&r[0]&&M.forEach((function(t){h.index+=t.length}))),a.push.apply(a,z)}a.shapes=l;var P=[];if(t.generateUV){for(var A=0,S=0;S<e.length;S++){var O=e[S],V=e[S-1];if(isNaN(O[0])){var E=c.Path.getPerMileages(O,!1),B=0;S>0&&(B=A+O[0].distanceTo(V[0]));for(var j=0;j<O.length;j++)P.push(B,E[j]);A=B}else console.error("索引无法生成纹理")}if(r){A=0;for(var k=0;k<r.length;k++){var N=r[k],q=r[k-1];B=0;k>0&&(B=A+N[0][0].distanceTo(q[0][0]));for(var T=0;T<N.length;T++){var U=N[T];for(E=c.Path.getPerMileages(U,!1),j=0;j<U.length;j++)P.push(B,E[j])}A=B}}var F=[];switch(t.axisPlane){case f.AxisPlane.XY:y.map((function(t){F.push(t.x,t.y)})),d&&d.forEach((function(t){t.forEach((function(t){F.push(t.x,t.y)}))}));break;case f.AxisPlane.XZ:y.map((function(t){F.push(t.x,t.z)})),d&&d.forEach((function(t){t.forEach((function(t){F.push(t.x,t.z)}))}));break;case f.AxisPlane.YZ:y.map((function(t){F.push(t.y,t.z)})),d&&d.forEach((function(t){t.forEach((function(t){F.push(t.y,t.z)}))}))}P.push.apply(P,n(F,F))}var C=a||[],I=m.default.verctorToNumbers(l);return e.pop(),e.pop(),{position:I,index:C,uv:P}}e.linkSide=x,e.linkSides=b;var w,M={textureEnable:!0,textureScale:new a.Vec2(1,1),smoothAngle:Math.PI/180*30,sealStart:!1,sealEnd:!1,normal:s.Vec3.UnitZ},z=_.m4(),P=_.m4(),A=h.quat(),S=(h.quat(),s.v3()),O=s.v3();e.extrude=function(t){t=i({sealEnd:!0,sealStart:!0,shapeClosed:!0,pathClosed:!1,generateUV:!0,autoIndex:!0,axisPlane:f.AxisPlane.XY,up:s.Vec3.Up,smoothAngle:30*v.RADIANS_PER_DEGREE,enableSmooth:!1},t),m.default.isCCW(t.shape)||t.shape.reverse(),t.holes&&t.holes.forEach((function(t){m.default.isCCW(t)||t.reverse()}));var e=new c.Path(t.path),r=[],n=t.shape;t.shapeClosed&&!n[0].equals(n[n.length-1])&&n.push(n[0].clone());var o=new c.Path(n,t.shapeClosed);if(t.enableSmooth)for(var a=1;a<o.length;a++)o.get(a).direction.dot(o.get((a+1)%o.length).direction)<Math.cos(t.smoothAngle)&&(o.splice(a+1,0,o.get(a).clone()),a++);var h=t.ups||[];d.isUndefined(o.first.z)&&(o.array=o.array.map((function(t){return s.v3(t.x,t.y,0)})),t.normal=t.normal||s.Vec3.UnitZ);var u=t.up,p=t.right,y=[];for(a=0;a<t.path.length;a++){var _,g=e.get(a),x=g.direction;_=h[a]||u||s.v3().crossVecs(p,x);var w=p;p||(w=s.v3().crossVecs(_,x).normalize()),z.makeBasis(w,_,x),z.setPosition(g);var M=o.clone();if(M.applyMat4(z),r.push(M),t.holes){var P=l.applyMat4(t.holes,z,!1);y.push(P)}}return b({shapes:r.map((function(t){return t._array})),holes:y,orgShape:o._array,orgHoles:t.holes,sealStart:t.sealStart,sealEnd:t.sealEnd,shapeClosed:t.shapeClosed,pathClosed:t.pathClosed,axisPlane:t.axisPlane,autoIndex:t.autoIndex,generateUV:t.generateUV})},e.extrude_obsolete=function(t,e,r){var n,o;if(void 0===r&&(r=M),r=i(i({},M),r),e.length<2)throw"路径节点数必须大于2";m.default.isCCW(t)||t.reverse();for(var a=r.normal,h=u.clone(t),d=new c.Path(t),_=0,v=1;v<d.length-1;v++)Math.acos(d.get(v).tangent.dot(d.get(v+1).tangent))>r.smoothAngle&&t.splice(v+_++,0,d.get(v).clone());if(r.shapeClosed){var g=d.get(-1).clone().sub(d.get(-2)).normalize(),x=d.get(0).clone().sub(d.get(-1)).normalize();Math.acos(g.dot(x))>r.smoothAngle&&t.push(t.get(-1).clone()),t.unshift(t.first.clone())}var w=e;!(w instanceof c.Path)&&w instanceof Array&&(w=new c.Path(e));var z=[];for(v=0;v<w.length;v++){var P=w[v],A=P.tangent,S=u.clone(t);if(u.rotateByUnitVectors(S,a,A),r.fixedY){var O=s.Vec3.UnitX;u.rotateByUnitVectors([O],a,A),(T=O.clone()).y=0,u.rotateByUnitVectors(S,O,T)}l.translate(S,P),z.push(S)}var V={index:0},E=y.flat(z);p.indexable(E,V);var B=b({shapes:z,shapeClosed:r.shapeClosed,pathClosed:r.isClosed2,orgShape:t}).index;d=new c.Path(t);var j=[];for(v=0;v<w.length;v++)for(var k=0;k<d.length;k++)j.push(d.get(k).tlen*r.textureScale.x,w.get(v).tlen*r.textureScale.y);var N=u.clone(h);a.dot(s.Vec3.UnitZ)<.9999&&u.rotateByUnitVectors(N,a,s.Vec3.UnitZ);var q=u.clone(h);if(u.rotateByUnitVectors(h,a,w[0].tangent),r.fixedY){O=s.Vec3.UnitX;u.rotateByUnitVectors([O],a,w[0].tangent),(T=O.clone()).y=0,u.rotateByUnitVectors(h,O,T)}if(l.translate(h,w[0]),u.rotateByUnitVectors(q,a,w.get(-1).tangent),r.fixedY){var T;O=s.Vec3.UnitX;u.rotateByUnitVectors([O],a,w.get(-1).tangent),(T=O.clone()).y=0,u.rotateByUnitVectors(q,O,T)}l.translate(q,w.get(-1));var U=f.triangulation(N,[],{normal:a});U.reverse(),r.sealStart&&p.indexable(h,V),r.sealEnd&&p.indexable(q,V);var F=[],C=E.length;if(r.sealStart)for(v=0;v<U.length;v++)U[v]+=C;if(r.sealEnd&&!r.sealStart)for(v=0;v<U.length;v++)F[v]=U[v]+C;if(r.sealEnd&&r.sealStart)for(v=0;v<U.length;v++)F[v]=U[v]+h.length;if(r.sealStart){E.push.apply(E,h),(n=B).push.apply(n,U);for(v=0;v<N.length;v++)j.push(N[v].x,N[v].y)}if(r.sealEnd){E.push.apply(E,q),F.reverse(),(o=B).push.apply(o,F);for(v=0;v<N.length;v++)j.push(N[v].x,N[v].y)}return{vertices:E,index:B,uvs:j}},function(t){t[t.Square=0]="Square",t[t.Round=1]="Round",t[t.Miter=2]="Miter",t[t.Bevel=0]="Bevel"}(w=e.JoinType||(e.JoinType={})),function(t){t[t.Square=0]="Square",t[t.Round=1]="Round",t[t.Butt=2]="Butt",t[t.etClosedLine=3]="etClosedLine",t[t.etClosedPolygon=4]="etClosedPolygon",t[t.etOpenButt=5]="etOpenButt",t[t.etOpenSquare=6]="etOpenSquare"}(e.EndType||(e.EndType={})),e.extrudeNext=function(t){var e=(t=i({sealEnd:!0,sealStart:!0,shapeClosed:!0,pathClosed:!1,generateUV:!0,autoIndex:!0,axisPlane:f.AxisPlane.XY,smoothAngle:30*v.RADIANS_PER_DEGREE,enableSmooth:!1},t)).shapeCenter?l.translate(t.path,t.shapeCenter,!1):t.path,r=t.shape;y.unique(e,(function(t,e){return t.equals(e)})),y.unique(r,(function(t,e){return t.equals(e)}));var n=new c.Path(e,t.pathClosed,!0),o=(t.shapeClosed,new c.Path(r,t.shapeClosed));if(t.enableSmooth)for(var a=1;a<o.length;a++)o.get(a).direction.dot(o.get((a+1)%o.length).direction)<t.smoothAngle&&(o.splice(a+1,0,o.get(a).clone()),a++);t.normal=t.normal||s.Vec3.UnitZ,d.isUndefined(o.first.z)&&(o.array=o.array.map((function(t){return s.v3(t.x,t.y,0)}))),t.up,t.right;var h=[],u=_.m4();switch(t.jtType){case w.Square:break;case w.Round:for(a=0;a<n.length;a++){var p=n.get(a),m=n.get(a-1),x=n.get(a+1),M=p.direction,V=p.bdirection,E=(p.bnormal,p.normal);0===a?A.setFromUnitVecs(s.Vec3.UnitZ,M):A.setFromUnitVecs(n.get(a-1).direction,M);var B=o.clone();A.setFromUnitVecs(M,V),z.makeRotationFromQuat(A),z.multiply(u),z.setPosition(p),B.applyMat4(z);for(var j=1/0,k=0,N=0;N<B.array.length;N++){var q=B.get(N),T=V.dot(S.copy(q).sub(B.get(0)));T<j&&(j=T,k=N)}var U=B.get(k);if(0!==a&&a!==n.length-1){var F=g.Distance.Point2Line_Vec3(U,m,S.copy(p).sub(m).normalize()),C=g.Distance.Point2Line_Vec3(U,p,S.copy(x).sub(p).normalize());S.copy(F).sub(U),O.copy(C).sub(U);for(var I=S.angleTo(O,E),R=Math.ceil(I/.1),D=I/R,Y=0;Y<=R;Y++)for(var Z=Y*D,X=0;X<B.length;X++){var L=B.get(X);(new s.Vec3).slerpVecs(S,O,Z),L.clone().sub(U)}}h.push(B)}break;case w.Miter:for(a=0;a<n.length;a++){M=(p=n.get(a)).direction,V=p.bdirection,p.bnormal,E=p.normal;0===a?A.setFromUnitVecs(s.Vec3.UnitZ,M):A.setFromUnitVecs(n.get(a-1).direction,M);B=o.clone();z.makeRotationFromQuat(A),u.premultiply(z),A.setFromUnitVecs(M,V),z.makeRotationFromQuat(A),z.multiply(u);var G=1/M.dot(V);S.crossVecs(E,V),P.copy(z),P.invert(),S.applyMat4(P),A.setFromUnitVecs(S,s.Vec3.Up),P.makeRotationFromQuat(A),B.applyMat4(P),B.scale(1,G,1),B.applyMat4(P.invert()),z.setPosition(p),B.applyMat4(z),h.push(B)}}return b({shapes:h.map((function(t){return t.array})),holes:[],orgShape:o._array,orgHoles:t.holes,sealStart:t.sealStart,sealEnd:t.sealEnd,shapeClosed:t.shapeClosed,pathClosed:t.pathClosed,axisPlane:t.axisPlane,autoIndex:t.autoIndex,generateUV:t.generateUV})}},384:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isString=e.isFinite=e.isUndefined=e.isDefined=void 0,e.isDefined=function(t){return null!=t},e.isUndefined=function(t){return void 0===t},e.isFinite=function(t){return"number"==typeof t&&globalThis.isFinite(t)},e.isString=function(t){return"string"==typeof t}},385:function(t,e,r){"use strict";r(158),Object.defineProperty(e,"__esModule",{value:!0}),e.Sphere=void 0;var i=r(360),n=function(){function t(t,e){void 0===t&&(t=i.v3()),void 0===e&&(e=0),this.center=t,this.radius=e}return t.prototype.applyMat4=function(t){throw new Error("Method not implemented.")},t.prototype.setComponents=function(t,e,r,i){return this.center.set(t,e,r),this.radius=i,this},t.prototype.copy=function(t){return this.center.copy(t.center),this.radius=t.radius,this},t.prototype.clone=function(){return(new t).copy(this)},t}();e.Sphere=n},386:function(t,e,r){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},n=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,n++)i[n]=o[s];return i},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.triangulation=e.AxisPlane=void 0;var s,a=o(r(448)),h=r(360),c=r(372),u=r(363),l=r(361),p=o(r(374));!function(t){t.XY="xy",t.XZ="xz",t.YZ="yz",t.XYZ="xyz"}(s=e.AxisPlane||(e.AxisPlane={})),e.triangulation=function(t,e,r){void 0===e&&(e=[]),void 0===r&&(r={normal:h.Vec3.UnitZ}),(r=i({feature:s.XYZ,dim:3},r)).feature!==s.XYZ&&(r.dim=2);var o=null,f=r.feature,y=r.dim,d=r.normal;d&&d.dot(h.Vec3.UnitZ)<1-l.delta4?(o=u.clone(t),u.rotateByUnitVectors(o,d,h.Vec3.UnitZ)):o=t;for(var _=n(o,c.flat(e)),v=p.default.verctorToNumbers(_,f),m=[],g=o.length,x=-1;x<e.length-1;x++){m.push(g),g+=e[x+1].length}return a.default(v,m,y)}},401:function(t,e,r){"use strict";r(158),Object.defineProperty(e,"__esModule",{value:!0}),e.m3=e.Mat3=void 0;var i=r(360).v3(),n=function(){function t(){this.elements=[1,0,0,0,1,0,0,0,1],this.isMat3=!0,arguments.length>0&&console.error("Mat3: the constructor no longer reads arguments. use .set() instead.")}return t.prototype.set=function(t,e,r,i,n,o,s,a,h){var c=this.elements;return c[0]=t,c[1]=i,c[2]=s,c[3]=e,c[4]=n,c[5]=a,c[6]=r,c[7]=o,c[8]=h,this},t.prototype.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},t.prototype.clone=function(){return(new t).fromArray(this.elements)},t.prototype.copy=function(t){var e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],this},t.prototype.setFromMat4=function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},t.prototype.applyToBufferAttribute=function(t){for(var e=0,r=t.count;e<r;e++)i.x=t.getX(e),i.y=t.getY(e),i.z=t.getZ(e),i.applyMat3(this),t.setXYZ(e,i.x,i.y,i.z);return t},t.prototype.multiply=function(t){return this.multiplyMatrices(this,t)},t.prototype.premultiply=function(t){return this.multiplyMatrices(t,this)},t.prototype.multiplyMatrices=function(t,e){var r=t.elements,i=e.elements,n=this.elements,o=r[0],s=r[3],a=r[6],h=r[1],c=r[4],u=r[7],l=r[2],p=r[5],f=r[8],y=i[0],d=i[3],_=i[6],v=i[1],m=i[4],g=i[7],x=i[2],b=i[5],w=i[8];return n[0]=o*y+s*v+a*x,n[3]=o*d+s*m+a*b,n[6]=o*_+s*g+a*w,n[1]=h*y+c*v+u*x,n[4]=h*d+c*m+u*b,n[7]=h*_+c*g+u*w,n[2]=l*y+p*v+f*x,n[5]=l*d+p*m+f*b,n[8]=l*_+p*g+f*w,this},t.prototype.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},t.prototype.determinant=function(){var t=this.elements,e=t[0],r=t[1],i=t[2],n=t[3],o=t[4],s=t[5],a=t[6],h=t[7],c=t[8];return e*o*c-e*s*h-r*n*c+r*s*a+i*n*h-i*o*a},t.prototype.getInverse=function(t,e){void 0===e&&(e=!1),t&&t.isMat4&&console.error("Mat3: .getInverse() no longer takes a Mat4 argument.");var r=t.elements,i=this.elements,n=r[0],o=r[1],s=r[2],a=r[3],h=r[4],c=r[5],u=r[6],l=r[7],p=r[8],f=p*h-c*l,y=c*u-p*a,d=l*a-h*u,_=n*f+o*y+s*d;if(0===_){var v="Mat3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(v);return console.warn(v),this.identity()}var m=1/_;return i[0]=f*m,i[1]=(s*l-p*o)*m,i[2]=(c*o-s*h)*m,i[3]=y*m,i[4]=(p*n-s*u)*m,i[5]=(s*a-c*n)*m,i[6]=d*m,i[7]=(o*u-l*n)*m,i[8]=(h*n-o*a)*m,this},t.prototype.transpose=function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},t.prototype.getNormalMat=function(t){return this.setFromMat4(t).getInverse(this).transpose()},t.prototype.transposeIntoArray=function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},t.prototype.setUvTransform=function(t,e,r,i,n,o,s){var a=Math.cos(n),h=Math.sin(n);this.set(r*a,r*h,-r*(a*o+h*s)+o+t,-i*h,i*a,-i*(-h*o+a*s)+s+e,0,0,1)},t.prototype.scale=function(t,e){var r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=e,r[4]*=e,r[7]*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.elements,n=i[0],o=i[3],s=i[6],a=i[1],h=i[4],c=i[7];return i[0]=e*n+r*a,i[3]=e*o+r*h,i[6]=e*s+r*c,i[1]=-r*n+e*a,i[4]=-r*o+e*h,i[7]=-r*s+e*c,this},t.prototype.translate=function(t,e){var r=this.elements;return r[0]+=t*r[2],r[3]+=t*r[5],r[6]+=t*r[8],r[1]+=e*r[2],r[4]+=e*r[5],r[7]+=e*r[8],this},t.prototype.equals=function(t){for(var e=this.elements,r=t.elements,i=0;i<9;i++)if(e[i]!==r[i])return!1;return!0},t.prototype.fromArray=function(t,e){void 0===e&&(e=0);for(var r=0;r<9;r++)this.elements[r]=t[r+e];return this},t.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t},t}();e.Mat3=n,e.m3=function(){return new n}},402:function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Polygon=void 0;var o=r(360),s=r(366),a=function(t){function e(e){var r=t.call(this,e)||this;return r.isPolygon=!0,r}return n(e,t),e.prototype.offset=function(t,r){void 0===r&&(r=o.Vec3.UnitY);for(var i=[],n=0;n<this.length;n++){var a=this.get(n),h=this.get((n+1)%this.length),c=new s.Segment(a,h);i.push(c),c.offset(t,r)}for(n=0;n<this.length;n++){var u=i[n],l=i[n+1],p=u.distanceLine(l);u.p1=p.closests[0],l.p0=p.closests[1]}for(n=0;n<this.length;n++)u=i[n];return new e},e.prototype.containPoint=function(t){},e}(r(382).Polyline);e.Polygon=a},403:function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Path=void 0;var o=r(360),s=r(361),a=r(384),h=r(404),c=r(410),u=r(363),l=function(t){function e(e,r,i){void 0===r&&(r=!1),void 0===i&&(i=!1);var n=t.call(this,e)||this;return n._calcNoraml=!1,n._closed=r,n.init(i),n}return n(e,t),e.prototype.init=function(t){if(0!==this.length){this.get(0).len=0,this.get(0).tlen=0;for(var e=this.length,r=0;r<e;r++){var i=this.get(r);0!==r&&(i.len=this.get(r).distanceTo(this.get(r-1)),i.tlen=this.get(r-1).tlen+i.len),this.get(r).direction=this.get((r+1)%this.length).clone().sub(this.get(r)).normalize()}if(this._closed||this.get(-1).direction.copy(this.get(-2).direction),t){for(r=0;r<e;r++){var n=this.get(r-1).direction,s=this.get(r).direction,a=new o.Vec3;a.crossVecs(n,s).normalize(),this.get(r).normal=a;var h=o.v3().addVecs(n,s).normalize();this.get(r).bdirection=h,this.get(r).bnormal=o.v3().crossVecs(h,a).normalize()}if(this._closed||(this.get(-1).bdirection=o.v3(),this.get(-1).normal=o.v3(),this.get(-1).bnormal=o.v3()),!this._closed){this.get(0).normal.copy(this.get(1).normal),this.get(0).bdirection.copy(this.get(0).direction);h=this.get(0).bdirection;this.get(0).bnormal.crossVecs(h,this.get(0).normal),this.get(-1).normal.copy(this.get(-2).normal),this.get(-1).bdirection.copy(this.get(-1).direction),h=this.get(-1).bdirection,this.get(-1).bnormal.crossVecs(h,this.get(-1).normal).normalize()}}}},Object.defineProperty(e.prototype,"closed",{get:function(){return this._closed},set:function(t){this._closed=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tlen",{get:function(){return 0===this.length?0:Math.max(this.get(-1).tlen,this.get(0).tlen)},enumerable:!1,configurable:!0}),e.prototype.applyMat4=function(t){c.applyMat4(this._array,t)},e.prototype.scale=function(t,e,r){u.scale(this._array,o.v3(t,e,r),!0)},e.prototype.splitByFromToDistance=function(t,r){if(void 0===t&&(t=0),void 0===r&&(r=0),r<=t)return null;for(var i=new e([]),n=0;n<this.length-1;n++){var s=this.get(n),a=this.get(n+1);if(s.tlen<=t&&a.tlen>=t){var h=(new o.Vec3).lerpVecs(s,a,(t-s.tlen)/(a.tlen-s.tlen));i.add(h)}if(s.tlen>t&&s.tlen<r&&i.add(s.clone()),s.tlen<=r&&a.tlen>=r){h=(new o.Vec3).lerpVecs(s,a,(r-s.tlen)/(a.tlen-s.tlen));return i.add(h),i}}return i},e.prototype.getPointByDistance=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=this.length-1);var i=s.clamp(t,0,this.get(-1).tlen);if(i!==t)return null;if(r-e==1)return{isNode:!1,point:(new o.Vec3).lerpVecs(this.get(e),this.get(r),(i-this.get(e).tlen)/this.get(r).len),direction:this.get(e).direction};var n=e+r>>1;return this.get(n).tlen>i?this.getPointByDistance(i,e,n):this.get(n).tlen<i?this.getPointByDistance(i,n,r):{isNode:!0,point:(new o.Vec3).lerpVecs(this.get(e),this.get(r),(i-this.get(e).tlen)/this.get(r).len),direction:this.get(e).direction}},e.prototype.getPointByDistancePure=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=this.length-1);var i=s.clamp(t,0,this.get(-1).tlen);if(i!==t)return null;if(r-e==1)return(new o.Vec3).lerpVecs(this.get(e),this.get(r),(i-this.get(e).tlen)/this.get(r).len);var n=e+r>>1;return this.get(n).tlen>i?this.getPointByDistancePure(i,e,n):this.get(n).tlen<i?this.getPointByDistancePure(i,n,r):this.get(n).clone()},e.prototype.splitAverage=function(t){for(var r=this.last.tlen/t,i=[],n=0,s=0;s<=t;s++)for(var a=s*r,h=n;h<this.length-1;h++)if(this.get(h).tlen<=a&&this.get(h+1).tlen>=a){var c=(new o.Vec3).lerpVecs(this.get(h),this.get(h+1),(a-this.get(h).tlen)/this.get(h+1).len);i.push(c),n=h;break}return new e(i)},e.prototype.splitAverageLength=function(t,e){void 0===e&&(e=!0);var r=this.last.tlen/t;return e&&(r=Math.round(r)),this.splitAverage(r)},e.prototype.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0==this.length){var r=t.shift();this.push(r),this.get(0).len=0,this.get(0).tlen=0}for(var i=0;i<t.length;i++){var n=t[i];n.len=n.distanceTo(this.get(-1)),n.tlen=this.get(-1).tlen+n.len,n.direction=n.clone().sub(this.get(-1)).normalize(),this.get(-1).direction?this.get(-1).direction.copy(n.direction):this.get(-1).direction=n.clone().sub(this.get(-1)).normalize(),this.push(n)}},e.totalMileages=function(t){for(var e=0,r=0,i=t.length-1;r<i;r++)e+=t[r+1].distanceTo(t[r]);return e},e.getPerMileages=function(t,e,r){void 0===e&&(e=!1);var i=[],n=0;i.push(n);for(var o=0,s=t.length-1;o<s;o++)n+=t[o+1].distanceTo(t[o]),i.push(n);if(e){var h=a.isDefined(r)?r:this.totalMileages(t);for(o=0,s=t.length;o<s;o++)i[o]/=h}return i},e}(h.ArrayList);e.Path=l},404:function(t,e,r){"use strict";var i=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,n++)i[n]=o[s];return i};Object.defineProperty(e,"__esModule",{value:!0}),e.ArrayList=void 0;var n=r(363),o=function(){function t(t){var e=this;this.isArrayList=!0,this._array=new Array,Array.isArray(t)?t.forEach((function(t,r){t.i=r,e._array.push(t)})):!0===t.isArrayList&&(null==t?void 0:t._array).forEach((function(t,r){t.i=r,e._array.push(t)}))}return Object.defineProperty(t.prototype,"array",{get:function(){return this._array},set:function(t){this._array=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._array.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"last",{get:function(){return this.get(-1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"first",{get:function(){return this._array[0]},enumerable:!1,configurable:!0}),t.prototype.map=function(t){return this._array.map(t)},t.prototype.push=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];(t=this._array).push.apply(t,e)},t.prototype.reverse=function(){return this._array.reverse(),this},t.prototype.pop=function(){return Array.prototype.pop.apply(this._array)},t.prototype.unshift=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(t=this._array).unshift.apply(t,e)},t.prototype.insertAt=function(t){for(var e,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];(e=this._array).splice.apply(e,i([t,0],r))},t.prototype.splice=function(t,e){for(var r,n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];(r=this._array).splice.apply(r,i([t,e],n))},t.prototype.get=function(t){return t<0&&(t=this._array.length+t),this._array[t]},t.prototype.forall=function(t){for(var e=0;e<this._array.length;e++)t(this._array[e])},t.prototype.clone=function(){return new this.constructor(n.clone(this._array))},t.prototype.classify=function(t){for(var e=[],r=0;r<this._array.length;r++)for(var i=0;i<e.length;i++)t(this._array[r],e[i][0],e[i])?e[i].push(this._array[r]):e.push([this._array[r]]);return e},t.prototype.unique=function(t,e){if(e){this._array.sort(e);for(var r=0;r<this._array.length;r++)for(var i=r+1;i<this._array.length&&!0===t(this._array[r],this._array[i]);i++)this._array.splice(i,1),i--;return this}for(r=0;r<this._array.length;r++)for(i=r+1;i<this._array.length;i++)!0===t(this._array[r],this._array[i])&&(this._array.splice(i,1),i--);return this},t}();e.ArrayList=o},405:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.circle=e.Circle=void 0;var i=r(360),n=r(363),o=r(367),s=function(){function t(t,e,r){void 0===t&&(t=new i.Vec3),void 0===e&&(e=0),void 0===r&&(r=i.Vec3.UnitY),this.center=t,this.radius=e,this.normal=r,this.startAngle=0,this.endAngle=2*Math.PI,this.radiusSqr=0}return t.prototype.area=function(){return Math.PI*this.radius*this.radius},t.prototype.arc1=function(t,e,r,i){this.setFrom3Points(t,e,r),this.startAngle=0,this.endAngle=n.angle(t.clone().sub(this.center).normalize(),e.clone().sub(this.center).normalize(),this.normal||i)},t.prototype.arc2=function(t,e,r,i,o){void 0===i&&(i=!1),this.radius=e.distanceTo(t),this.center.copy(t);var s=r.clone().sub(t),a=e.clone().sub(t);n.angle(a,s)},t.prototype.setFrom3Points=function(t,e,r,i){var n=e.clone().sub(t),s=r.clone().sub(t),a=e.clone().add(t).multiplyScalar(.5),h=r.clone().add(t).multiplyScalar(.5);i=i||n.clone().cross(s).normalize(),n.applyAxisAngle(i,Math.PI/2),s.applyAxisAngle(i,Math.PI/2);var c=new o.Line(a,a.clone().add(n)),u=new o.Line(h,h.clone().add(s)),l=c.distanceLine(u).closests[0],p=t.distanceToSquared(l);return this.center=l,this.radiusSqr=p,this.radius=Math.sqrt(p),this.normal=i,this},t}();e.Circle=s,e.circle=function(t,e,r){return new s(t,e,r)}},407:function(t,e,r){"use strict";r(368),r(369),r(370),r(371),r(158);var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferGeometry=void 0;var n=r(446),o=r(401),s=r(377),a=r(360),h=r(408),c=r(385),u=r(409),l=r(447),p=r(373),f=r(376),y=i(r(374)),d=1,_=new s.Mat4,v=new a.Vec3,m=new h.Box,g=new h.Box,x=new a.Vec3,b=function(){function t(){this.isBufferGeometry=!0,this.uuid="",this.type="BufferGeometry",Object.defineProperty(this,"id",{value:d+=2}),this.name="",this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.drawRange={start:0,count:1/0}}return t.prototype.setFromGeometry=function(t){return this.setAttribute("position",new u.Float32BufferAttribute(t.position,3)),t.uv&&this.setAttribute("uv",new u.Float32BufferAttribute(t.uv,2)),t.index&&this.setIndex(t.index),this},t.prototype.getIndex=function(){return this.index},t.prototype.setIndex=function(t){Array.isArray(t)?this.index=new(n.Vec.max(t)>65535?u.Uint32BufferAttribute:u.Uint16BufferAttribute)(t,1):t instanceof u.BufferAttribute?this.index=t:this.index=new(n.Vec.max(t)>65535?u.Uint32BufferAttribute:u.Uint16BufferAttribute)(t,1)},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.setAttribute=function(t,e){return this.attributes[t]=e,this},t.prototype.addAttribute=function(t,e,r){if(void 0===r&&(r=1),Array.isArray(e))if(e[0]instanceof p.Vec2){var i=y.default.verctorToNumbers(e);this.setAttribute(t,new u.Float32BufferAttribute(i,2))}else if(e[0]instanceof a.Vec3){i=y.default.verctorToNumbers(e);this.setAttribute(t,new u.Float32BufferAttribute(i,3))}else if(e[0]instanceof f.Vec4){i=y.default.verctorToNumbers(e);this.setAttribute(t,new u.Float32BufferAttribute(i,4))}else isNaN(e[0])?console.error("类型不存在"):this.setAttribute(t,new u.Float32BufferAttribute(e,r));else e instanceof u.BufferAttribute?this.attributes[t]=e:l.isBufferArray(e)&&this.setAttribute(t,new u.BufferAttribute(e,r));return this},t.prototype.deleteAttribute=function(t){return delete this.attributes[t],this},t.prototype.addGroup=function(t,e,r){this.groups.push({start:t,count:e,materialIndex:void 0!==r?r:0})},t.prototype.clearGroups=function(){this.groups=[]},t.prototype.setDrawRange=function(t,e){this.drawRange.start=t,this.drawRange.count=e},t.prototype.applyMat4=function(t){var e=this.attributes.position;void 0!==e&&(e.applyMat4(t),e.needsUpdate=!0);var r=this.attributes.normal;if(void 0!==r){var i=(new o.Mat3).getNormalMat(t);r.applyNormalMat(i),r.needsUpdate=!0}var n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),this.boundingBox||this.computeBoundingBox(),this.boundingSphere||this.computeBoundingSphere(),this},t.prototype.rotateX=function(t){return _.makeRotationX(t),this.applyMat4(_),this},t.prototype.rotateY=function(t){return _.makeRotationY(t),this.applyMat4(_),this},t.prototype.rotateZ=function(t){return _.makeRotationZ(t),this.applyMat4(_),this},t.prototype.translate=function(t,e,r){return _.makeTranslation(t,e,r),this.applyMat4(_),this},t.prototype.scale=function(t,e,r){return _.makeScale(t,e,r),this.applyMat4(_),this},t.prototype.lookAt=function(t){return _.lookAt(a.v3(),t,a.Vec3.UnitY),this.applyMat4(_),this},t.prototype.center=function(){return this.computeBoundingBox(),this.boundingBox.getCenter(v).negate(),this.translate(v.x,v.y,v.z),this},t.prototype.setFromObject=function(t){var e=t.geometry;if(t.isPoints||t.isLine){var r=new u.Float32BufferAttribute(3*e.vertices.length,3),i=new u.Float32BufferAttribute(3*e.colors.length,3);if(this.setAttribute("position",r.copyVec3sArray(e.vertices)),this.setAttribute("color",i.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var n=new u.Float32BufferAttribute(e.lineDistances.length,1);this.setAttribute("lineDistance",n.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh;return this},t.prototype.setFromPoints=function(t){for(var e=[],r=0,i=t.length;r<i;r++){var n=t[r];e.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new u.Float32BufferAttribute(e,3)),this},t.prototype.updateFromObject=function(t){var e,r=t.geometry;if(t.isMesh){var i=r.__directGeometry;!0===r.elementsNeedUpdate&&(i=void 0,r.elementsNeedUpdate=!1),i.verticesNeedUpdate=r.verticesNeedUpdate,i.normalsNeedUpdate=r.normalsNeedUpdate,i.colorsNeedUpdate=r.colorsNeedUpdate,i.uvsNeedUpdate=r.uvsNeedUpdate,i.groupsNeedUpdate=r.groupsNeedUpdate,r.verticesNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.groupsNeedUpdate=!1,r=i}return!0===r.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVec3sArray(r.vertices),e.needsUpdate=!0),r.verticesNeedUpdate=!1),!0===r.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVec3sArray(r.normals),e.needsUpdate=!0),r.normalsNeedUpdate=!1),!0===r.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(r.colors),e.needsUpdate=!0),r.colorsNeedUpdate=!1),r.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVec2sArray(r.uvs),e.needsUpdate=!0),r.uvsNeedUpdate=!1),r.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(r.lineDistances),e.needsUpdate=!0),r.lineDistancesNeedUpdate=!1),r.groupsNeedUpdate&&(r.computeGroups(t.geometry),this.groups=r.groups,r.groupsNeedUpdate=!1),this},t.prototype.computeBoundingBox=function(){this.boundingBox||(this.boundingBox=new h.Box);var t=this.attributes.position,e=this.morphAttributes.position;if(t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var r=0,i=e.length;r<i;r++){var n=e[r];m.setFromBufferAttribute(n),this.morphTargetsRelative?(x.addVecs(this.boundingBox.min,m.min),this.boundingBox.expandByPoint(x),x.addVecs(this.boundingBox.max,m.max),this.boundingBox.expandByPoint(x)):(this.boundingBox.expandByPoint(m.min),this.boundingBox.expandByPoint(m.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},t.prototype.computeBoundingSphere=function(){this.boundingSphere||(this.boundingSphere=new c.Sphere);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var r=this.boundingSphere.center;if(m.setFromBufferAttribute(t),e)for(var i=0,n=e.length;i<n;i++){var o=e[i];g.setFromBufferAttribute(o),this.morphTargetsRelative?(x.addVecs(m.min,g.min),m.expandByPoint(x),x.addVecs(m.max,g.max),m.expandByPoint(x)):(m.expandByPoint(g.min),m.expandByPoint(g.max))}m.getCenter(r);var s=0;for(i=0,n=t.count;i<n;i++)x.fromBufferAttribute(t,i),s=Math.max(s,r.distanceToSquared(x));if(e)for(i=0,n=e.length;i<n;i++){o=e[i];for(var a=this.morphTargetsRelative,h=0,u=o.count;h<u;h++)x.fromBufferAttribute(o,h),a&&(v.fromBufferAttribute(t,h),x.add(v)),s=Math.max(s,r.distanceToSquared(x))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},t.prototype.computeFaceNormals=function(){},t.prototype.computeVertexNormals=function(){var t=this.index,e=this.attributes;if(e.position){var r=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new u.BufferAttribute(new Float32Array(r.length),3));else for(var i=e.normal.array,n=0,o=i.length;n<o;n++)i[n]=0;var s,h,c,l=e.normal.array,p=new a.Vec3,f=new a.Vec3,y=new a.Vec3,d=new a.Vec3,_=new a.Vec3;if(t){var v=t.array;for(n=0,o=t.count;n<o;n+=3)s=3*v[n+0],h=3*v[n+1],c=3*v[n+2],p.fromArray(r,s),f.fromArray(r,h),y.fromArray(r,c),d.subVecs(y,f),_.subVecs(p,f),d.cross(_),l[s]+=d.x,l[s+1]+=d.y,l[s+2]+=d.z,l[h]+=d.x,l[h+1]+=d.y,l[h+2]+=d.z,l[c]+=d.x,l[c+1]+=d.y,l[c+2]+=d.z}else for(n=0,o=r.length;n<o;n+=9)p.fromArray(r,n),f.fromArray(r,n+3),y.fromArray(r,n+6),d.subVecs(y,f),_.subVecs(p,f),d.cross(_),l[n]=d.x,l[n+1]=d.y,l[n+2]=d.z,l[n+3]=d.x,l[n+4]=d.y,l[n+5]=d.z,l[n+6]=d.x,l[n+7]=d.y,l[n+8]=d.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},t.prototype.merge=function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r=this.attributes;for(var i in r)if(void 0!==t.attributes[i])for(var n=r[i].array,o=t.attributes[i],s=o.array,a=o.itemSize*e,h=Math.min(s.length,n.length-a),c=0,u=a;c<h;c++,u++)n[u]=s[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},t.prototype.normalizeNormals=function(){for(var t=this.attributes.normal,e=0,r=t.count;e<r;e++)x.x=t.getX(e),x.y=t.getY(e),x.z=t.getZ(e),x.normalize(),t.setXYZ(e,x.x,x.y,x.z)},t.prototype.toFlat=function(){var e=this.index.array,r=this.attributes,i=new t;function n(t,e){for(var r=t.array,i=t.itemSize,n=new r.constructor(e.length*i),o=0,s=0,a=0,h=e.length;a<h;a++){o=e[a]*i;for(var c=0;c<i;c++)n[s++]=r[o++]}return new u.BufferAttribute(n,i)}for(var o in r){var s=n(r[o],e);i.setAttribute(o,s)}var a=e.map((function(t,e){return e}));return i.setIndex(a),i},t.prototype.toNonIndexed=function(){function e(t,e){for(var r=t.array,i=t.itemSize,n=new r.constructor(e.length*i),o=0,s=0,a=0,h=e.length;a<h;a++){o=e[a]*i;for(var c=0;c<i;c++)n[s++]=r[o++]}return new u.BufferAttribute(n,i)}if(void 0===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var r=new t,i=this.index.array,n=this.attributes;for(var o in n){var s=e(n[o],i);r.setAttribute(o,s)}var a=this.morphAttributes;for(o in a){for(var h=[],c=a[o],l=0,p=c.length;l<p;l++){s=e(c[l],i);h.push(s)}r.morphAttributes[o]=h}r.morphTargetsRelative=this.morphTargetsRelative;for(var f=this.groups,y=(l=0,f.length);l<y;l++){var d=f[l];r.addGroup(d.start,d.count,d.materialIndex)}return r},t.prototype.toJSON=function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var r in e)void 0!==e[r]&&(t[r]=e[r]);return t}t.data={attributes:{}};var i=this.index;i&&(t.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});var n=this.attributes;for(var r in n){var o=(p=n[r]).toJSON();""!==p.name&&(o.name=p.name),t.data.attributes[r]=o}var s={},a=!1;for(var r in this.morphAttributes){for(var h=this.morphAttributes[r],c=[],u=0,l=h.length;u<l;u++){var p;o=(p=h[u]).toJSON();""!==p.name&&(o.name=p.name),c.push(o)}c.length>0&&(s[r]=c,a=!0)}a&&(t.data.morphAttributes=s,t.data.morphTargetsRelative=this.morphTargetsRelative);var f=this.groups;f.length>0&&(t.data.groups=JSON.parse(JSON.stringify(f)));var y=this.boundingSphere;return y&&(t.data.boundingSphere={center:y.center.toArray(),radius:y.radius}),t},t.prototype.userData=function(t){throw new Error("Method not implemented.")},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){var e,r,i;this.attributes={},this.morphAttributes={},this.groups=[],this.name=t.name;var n=t.index;n&&this.setIndex(n.clone());var o=t.attributes;for(e in o){var s=o[e];this.setAttribute(e,s.clone())}var a=t.morphAttributes;for(e in a){var h=[],c=a[e];for(r=0,i=c.length;r<i;r++)h.push(c[r].clone());this.morphAttributes[e]=h}this.morphTargetsRelative=t.morphTargetsRelative;var u=t.groups;for(r=0,i=u.length;r<i;r++){var l=u[r];this.addGroup(l.start,l.count,l.materialIndex)}var p=t.boundingBox;p&&(this.boundingBox=p.clone());var f=t.boundingSphere;return f&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},t}();e.BufferGeometry=b},408:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Box=void 0;var i=r(360),n=new i.Vec3,o=function(){function t(t,e){void 0===t&&(t=i.v3(1/0,1/0,1/0)),void 0===e&&(e=i.v3(-1/0,-1/0,-1/0)),this._center=i.v3(),this.min=t,this.max=e}return Object.defineProperty(t.prototype,"center",{get:function(){return this._center.add(this.min,this.max).multiplyScalar(.5)},enumerable:!1,configurable:!0}),t.prototype.setFromPoints=function(t){this.min.set(1/0,1/0,1/0),this.max.set(-1/0,-1/0,-1/0),this.expand.apply(this,t)},t.prototype.expand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0;r<t.length;r++){var i=t[r];this.min.min(i),this.max.max(i)}this.center.addVecs(this.min,this.max).multiplyScalar(.5)},t.prototype.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},t.prototype.setFromCenterAndSize=function(t,e){var r=n.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this},t.prototype.setFromBufferAttribute=function(t){for(var e=1/0,r=1/0,i=1/0,n=-1/0,o=-1/0,s=-1/0,a=0,h=t.count;a<h;a++){var c=t.getX(a),u=t.getY(a),l=t.getZ(a);c<e&&(e=c),u<r&&(r=u),l<i&&(i=l),c>n&&(n=c),u>o&&(o=u),l>s&&(s=l)}return this.min.set(e,r,i),this.max.set(n,o,s),this},t.prototype.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},t.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},t.prototype.getCenter=function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new i.Vec3),this.isEmpty()?t.set(0,0,0):t.addVecs(this.min,this.max).multiplyScalar(.5)},t}();e.Box=o},409:function(t,e,r){"use strict";r(368),r(369),r(370),r(371);var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Float64BufferAttribute=e.Float32BufferAttribute=e.Uint32BufferAttribute=e.Int32BufferAttribute=e.Uint16BufferAttribute=e.Int16BufferAttribute=e.Uint8ClampedBufferAttribute=e.Uint8BufferAttribute=e.Int8BufferAttribute=e.BufferAttribute=void 0;var o=r(373),s=r(360),a=r(376),h=new s.Vec3,c=function(){function t(t,e,r){this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===r,this.updateRange={offset:0,count:-1},this.version=0}return Object.defineProperty(t.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++},enumerable:!1,configurable:!0}),t.prototype.onUpload=function(t){return this.onUploadCallback=t,this},t.prototype.setUsage=function(t){return this},t.prototype.copy=function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this},t.prototype.copyAt=function(t,e,r){t*=this.itemSize,r*=e.itemSize;for(var i=0,n=this.itemSize;i<n;i++)this.array[t+i]=e.array[r+i];return this},t.prototype.copyArray=function(t){return this.array.set(t),this},t.prototype.copyColorsArray=function(t){this.array;for(var e=0,r=t.length;e<r;e++)t[e];return this},t.prototype.copyVec2sArray=function(t){for(var e=this.array,r=0,i=0,n=t.length;i<n;i++){var s=t[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyVec2sArray(): vector is undefined",i),s=new o.Vec2),e[r++]=s.x,e[r++]=s.y}return this},t.prototype.copyVec3sArray=function(t){for(var e=this.array,r=0,i=0,n=t.length;i<n;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVec3sArray(): vector is undefined",i),o=new s.Vec3),e[r++]=o.x,e[r++]=o.y,e[r++]=o.z}return this},t.prototype.copyVec4sArray=function(t){for(var e=this.array,r=0,i=0,n=t.length;i<n;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVec4sArray(): vector is undefined",i),o=new a.Vec4),e[r++]=o.x,e[r++]=o.y,e[r++]=o.z,e[r++]=o.w}return this},t.prototype.applyMat3=function(t){for(var e=0,r=this.count;e<r;e++)h.x=this.getX(e),h.y=this.getY(e),h.z=this.getZ(e),h.applyMat3(t),this.setXYZ(e,h.x,h.y,h.z);return this},t.prototype.applyMat4=function(t){for(var e=0,r=this.count;e<r;e++)h.x=this.getX(e),h.y=this.getY(e),h.z=this.getZ(e),h.applyMat4(t),this.setXYZ(e,h.x,h.y,h.z);return this},t.prototype.applyNormalMat=function(t){for(var e=0,r=this.count;e<r;e++)h.x=this.getX(e),h.y=this.getY(e),h.z=this.getZ(e),h.applyNormalMat(t),this.setXYZ(e,h.x,h.y,h.z);return this},t.prototype.transformDirection=function(t){for(var e=0,r=this.count;e<r;e++)h.x=this.getX(e),h.y=this.getY(e),h.z=this.getZ(e),h.transformDirection(t),this.setXYZ(e,h.x,h.y,h.z);return this},t.prototype.set=function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},t.prototype.getX=function(t){return this.array[t*this.itemSize]},t.prototype.setX=function(t,e){return this.array[t*this.itemSize]=e,this},t.prototype.getY=function(t){return this.array[t*this.itemSize+1]},t.prototype.setY=function(t,e){return this.array[t*this.itemSize+1]=e,this},t.prototype.getZ=function(t){return this.array[t*this.itemSize+2]},t.prototype.setZ=function(t,e){return this.array[t*this.itemSize+2]=e,this},t.prototype.getW=function(t){return this.array[t*this.itemSize+3]},t.prototype.setW=function(t,e){return this.array[t*this.itemSize+3]=e,this},t.prototype.setXY=function(t,e,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this},t.prototype.setXYZ=function(t,e,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this},t.prototype.setXYZW=function(t,e,r,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this.array[t+3]=n,this},t.prototype.clone=function(){return new t(this.array,this.itemSize).copy(this)},t.prototype.toJSON=function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}},t}();e.BufferAttribute=c;var u=function(t){function e(e,r,i){void 0===i&&(i=!1);return Array.isArray(e)&&(e=new Int8Array(e)),t.call(this,new Int8Array(e),r,i)||this}return n(e,t),e}(c);e.Int8BufferAttribute=u;var l=function(t){function e(e,r,i){void 0===i&&(i=!1);return Array.isArray(e)&&(e=new Uint8Array(e)),t.call(this,e,r,i)||this}return n(e,t),e}(c);e.Uint8BufferAttribute=l;var p=function(t){function e(e,r,i){void 0===i&&(i=!1);return Array.isArray(e)&&(e=new Uint8ClampedArray(e)),t.call(this,e,r,i)||this}return n(e,t),e}(c);e.Uint8ClampedBufferAttribute=p;var f=function(t){function e(e,r,i){void 0===i&&(i=!1);return Array.isArray(e)&&(e=new Int16Array(e)),t.call(this,e,r,i)||this}return n(e,t),e}(c);e.Int16BufferAttribute=f;var y=function(t){function e(e,r,i){void 0===i&&(i=!1);return Array.isArray(e)&&(e=new Uint16Array(e)),t.call(this,e,r)||this}return n(e,t),e}(c);e.Uint16BufferAttribute=y;var d=function(t){function e(e,r,i){void 0===i&&(i=!1);return Array.isArray(e)&&(e=new Int32Array(e)),t.call(this,e,r,i)||this}return n(e,t),e}(c);e.Int32BufferAttribute=d;var _=function(t){function e(e,r,i){void 0===i&&(i=!1);return Array.isArray(e)&&(e=new Uint32Array(e)),t.call(this,e,r,i)||this}return n(e,t),e}(c);e.Uint32BufferAttribute=_;var v=function(t){function e(e,r,i){void 0===i&&(i=!1);return Array.isArray(e)&&(e=new Float32Array(e)),t.call(this,e,r,i)||this}return n(e,t),e}(c);e.Float32BufferAttribute=v;var m=function(t){function e(e,r,i){void 0===i&&(i=!1);return Array.isArray(e)&&(e=new Float64Array(e)),t.call(this,e,r,i)||this}return n(e,t),e}(c);e.Float64BufferAttribute=m},410:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isInOnePlane=e.recognitionPlane=e.projectOnPlane=e.reverseOnPlane=e.simplifyPointList=e.applyMat4=e.rotateByUnitVecs=e.rotate=e.translate=e.applyQuat=e.boundingBox=e.VecCompare=void 0;var i=r(365),n=r(360),o=r(361),s=r(367),a=r(378),h=r(363);n.v3();function c(t,e){return t.x===e.x?void 0!==t.z&&t.y===e.y?t.z-e.z:t.y-e.y:t.x-e.x}function u(t,e,r){return void 0===r&&(r=!0),r?(t.flat(1/0).forEach((function(t){t.applyQuat(e)})),t):u(h.clone(t),e)}function l(t){t.sort(c);for(var e=new s.Line(t[0],t.get(-1)),r=-1/0,i=-1,n=1;n<t.length-1;n++){var o=t[n],h=e.distancePoint(o).distance;h>r&&(r=h,i=n)}var u=new a.Plane;return u.setFromThreePoint(t[0],t.get(-1),t[i]),u}e.VecCompare=c,e.boundingBox=function(t){for(var e=new n.Vec3(1/0,1/0,1/0),r=new n.Vec3(-1/0,-1/0,-1/0),i=0;i<t.length;i++)e.min(t[i]),r.max(t[i]);return[e,r]},e.applyQuat=u,e.translate=function t(e,r,i){return void 0===i&&(i=!0),i?(e.flat(1/0).forEach((function(t){t.add(r)})),e):t(h.clone(e))},e.rotate=function(t,e,r,n){return void 0===n&&(n=!0),u(t,(new i.Quat).setFromAxisAngle(e,r),n)},e.rotateByUnitVecs=function(t,e,r,n){return void 0===n&&(n=!0),u(t,(new i.Quat).setFromUnitVecs(e,r),n)},e.applyMat4=function t(e,r,i){return void 0===i&&(i=!0),i?(e.flat(1/0).forEach((function(t){t.applyMat4(r)})),e):t(h.clone(e),r)},e.simplifyPointList=function(t,e,r){void 0===e&&(e=.1),void 0===r&&(r=Math.PI/180*5);for(var i=0;i<t.length;i++){var n=t[i],o=t[i+1];n.distanceTo(o)<e&&(0===i?t.remove(i+1,1):i===t.length-2?t.splice(i,1):t.splice(i,2,n.clone().add(o).multiplyScalar(.5)),i--)}for(i=1;i<t.length-1;i++){var s=t[i-1];n=t[i],o=t[i+1];Math.acos(n.clone().sub(s).normalize().dot(o.clone().sub(n).normalize()))<r&&(t.splice(i,1),i--)}return t},e.reverseOnPlane=function(t,e){},e.projectOnPlane=function t(e,r,i,n){if(void 0===i&&(i=r.normal),void 0===n&&(n=!0),n){for(var o=0;o<e.length;o++){e[o].projectDirectionOnPlane(r,i)}return e}return t(h.clone(e),r,i)},e.recognitionPlane=l,e.isInOnePlane=function(t,e){void 0===e&&(e=o.delta4);for(var r=l(t),i=0;i<t.length;i++){var n=t[i];if(r.distancePoint(n)>=e)return!1}return r}},411:function(t,e,r){"use strict";r(368),r(369),r(370),r(371),r(158),Object.defineProperty(e,"__esModule",{value:!0}),e.Delaunator=void 0;var i=Math.pow(2,-52),n=new Uint32Array(512),o=function(){function t(t){var e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;var r=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}return t.from=function(e){for(var r=e.length,i=new Float64Array(r),n=0;n<r;n++){var o=e[n];i[n]=o}return new t(i)},t.fromVecs=function(e){for(var r=[],i=0;i<e.length;i++)r.push(e[i].x,e[i].y);return t.from(r)},t.prototype.update=function(){for(var t=this,e=t.coords,r=t._hullPrev,n=t._hullNext,o=t._hullTri,a=t._hullHash,l=e.length>>1,p=1/0,f=1/0,y=-1/0,d=-1/0,_=0;_<l;_++){(T=e[2*_])<p&&(p=T),(U=e[2*_+1])<f&&(f=U),T>y&&(y=T),U>d&&(d=U),this._ids[_]=_}var v=(p+y)/2,m=(f+d)/2,g=1/0,x=0,b=0,w=0;for(_=0;_<l;_++){(P=s(v,m,e[2*_],e[2*_+1]))<g&&(x=_,g=P)}var M=e[2*x],z=e[2*x+1];g=1/0;for(_=0;_<l;_++){var P;if(_!==x)(P=s(M,z,e[2*_],e[2*_+1]))<g&&P>0&&(b=_,g=P)}var A=e[2*b],S=e[2*b+1],O=1/0;for(_=0;_<l;_++)if(_!==x&&_!==b){var V=c(M,z,A,S,e[2*_],e[2*_+1]);V<O&&(w=_,O=V)}var E=e[2*w],B=e[2*w+1];if(O===1/0){for(_=0;_<l;_++)this._dists[_]=e[2*_]-e[0]||e[2*_+1]-e[1];u(this._ids,this._dists,0,l-1);for(var j=new Uint32Array(l),k=0,N=(_=0,-1/0);_<l;_++){var q=this._ids[_];this._dists[q]>N&&(j[k++]=q,N=this._dists[q])}return this.hull=j.subarray(0,k),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(h(M,z,A,S,E,B)){_=b;var T=A,U=S;b=w,A=E,S=B,w=_,E=T,B=U}var F=function(t,e,r,i,n,o){var s=r-t,a=i-e,h=n-t,c=o-e,u=s*s+a*a,l=h*h+c*c,p=.5/(s*c-a*h);return{x:t+(c*u-a*l)*p,y:e+(s*l-h*u)*p}}(M,z,A,S,E,B);this._cx=F.x,this._cy=F.y;for(_=0;_<l;_++)this._dists[_]=s(e[2*_],e[2*_+1],F.x,F.y);u(this._ids,this._dists,0,l-1),this._hullStart=x;var C=3;n[x]=r[w]=b,n[b]=r[x]=w,n[w]=r[b]=x,o[x]=0,o[b]=1,o[w]=2,a.fill(-1),a[this._hashKey(M,z)]=x,a[this._hashKey(A,S)]=b,a[this._hashKey(E,B)]=w,this.trianglesLen=0,this._addTriangle(x,b,w,-1,-1,-1);for(var I=0,R=void 0,D=void 0;I<this._ids.length;I++){T=e[2*(_=this._ids[I])],U=e[2*_+1];if(I>0){if(void 0===R||void 0===D)continue;if(Math.abs(T-R)<=i&&Math.abs(U-D)<=i)continue}if(R=T,D=U,_!==x&&_!==b&&_!==w){for(var Y=0,Z=(k=0,this._hashKey(T,U));k<this._hashSize&&(-1===(Y=a[(Z+k)%this._hashSize])||Y===n[Y]);k++);for(var X=Y=r[Y],L=void 0;L=n[X],!h(T,U,e[2*X],e[2*X+1],e[2*L],e[2*L+1]);)if((X=L)===Y){X=-1;break}if(-1!==X){var G=this._addTriangle(X,_,n[X],-1,-1,o[X]);o[_]=this._legalize(G+2),o[X]=G,C++;for(var Q=n[X];L=n[Q],h(T,U,e[2*Q],e[2*Q+1],e[2*L],e[2*L+1]);)G=this._addTriangle(Q,_,L,o[_],-1,o[Q]),o[_]=this._legalize(G+2),n[Q]=Q,C--,Q=L;if(X===Y)for(;h(T,U,e[2*(L=r[X])],e[2*L+1],e[2*X],e[2*X+1]);)G=this._addTriangle(L,_,X,-1,o[X],o[L]),this._legalize(G+2),o[L]=G,n[X]=X,C--,X=L;this._hullStart=r[_]=X,n[X]=r[Q]=_,n[_]=Q,a[this._hashKey(T,U)]=_,a[this._hashKey(e[2*X],e[2*X+1])]=X}}}this.hull=new Uint32Array(C);for(_=0,X=this._hullStart;_<C;_++)this.hull[_]=X,X=n[X];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)},t.prototype._hashKey=function(t,e){return Math.floor((r=t-this._cx,i=e-this._cy,n=r/(Math.abs(r)+Math.abs(i)),(i>0?3-n:1+n)/4*this._hashSize))%this._hashSize;var r,i,n},t.prototype._legalize=function(t){for(var e,r,i,o,s,a,h,c,u,l,p,f,y,d,_,v,m=this._triangles,g=this._halfedges,x=this.coords,b=0,w=0;;){var M=g[t],z=t-t%3;if(w=z+(t+2)%3,-1!==M){var P=M-M%3,A=z+(t+1)%3,S=P+(M+2)%3,O=m[w],V=m[t],E=m[A],B=m[S];if(e=x[2*O],r=x[2*O+1],i=x[2*V],o=x[2*V+1],s=x[2*E],a=x[2*E+1],h=x[2*B],c=x[2*B+1],u=void 0,l=void 0,p=void 0,f=void 0,y=void 0,d=void 0,void 0,_=void 0,v=void 0,(u=e-h)*((f=o-c)*(v=(y=s-h)*y+(d=a-c)*d)-(_=(p=i-h)*p+f*f)*d)-(l=r-c)*(p*v-_*y)+(u*u+l*l)*(p*d-f*y)<0){m[t]=B,m[M]=O;var j=g[S];if(-1===j){var k=this._hullStart;do{if(this._hullTri[k]===S){this._hullTri[k]=t;break}k=this._hullPrev[k]}while(k!==this._hullStart)}this._link(t,j),this._link(M,g[w]),this._link(w,S);var N=P+(M+1)%3;b<n.length&&(n[b++]=N)}else{if(0===b)break;t=n[--b]}}else{if(0===b)break;t=n[--b]}}return w},t.prototype._link=function(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)},t.prototype._addTriangle=function(t,e,r,i,n,o){var s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=e,this._triangles[s+2]=r,this._link(s,i),this._link(s+1,n),this._link(s+2,o),this.trianglesLen+=3,s},t}();function s(t,e,r,i){var n=t-r,o=e-i;return n*n+o*o}function a(t,e,r,i,n,o){var s=(i-e)*(n-t),a=(r-t)*(o-e);return Math.abs(s-a)>=33306690738754716e-32*Math.abs(s+a)?s-a:0}function h(t,e,r,i,n,o){return(a(n,o,t,e,r,i)||a(t,e,r,i,n,o)||a(r,i,n,o,t,e))<0}function c(t,e,r,i,n,o){var s=r-t,a=i-e,h=n-t,c=o-e,u=s*s+a*a,l=h*h+c*c,p=.5/(s*c-a*h),f=(c*u-a*l)*p,y=(s*l-h*u)*p;return f*f+y*y}function u(t,e,r,i){if(i-r<=20)for(var n=r+1;n<=i;n++){for(var o=e[a=t[n]],s=n-1;s>=r&&e[t[s]]>o;)t[s+1]=t[s--];t[s+1]=a}else{s=i;l(t,r+i>>1,n=r+1),e[t[r]]>e[t[i]]&&l(t,r,i),e[t[n]]>e[t[i]]&&l(t,n,i),e[t[r]]>e[t[n]]&&l(t,r,n);var a;for(o=e[a=t[n]];;){do{n++}while(e[t[n]]<o);do{s--}while(e[t[s]]>o);if(s<n)break;l(t,n,s)}t[r+1]=t[s],t[s]=a,i-n+1>=s-r?(u(t,e,n,i),u(t,e,r,s-1)):(u(t,e,r,s-1),u(t,e,n,i))}}function l(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}e.Delaunator=o},412:function(t,e,r){"use strict";r(158),r(368),r(369),r(370),r(371);var i=this&&this.__generator||function(t,e){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Voronoi=void 0;var n=function(){function t(){this._=[]}return t.prototype.moveTo=function(t,e){this._.push([t,e])},t.prototype.closePath=function(){this._.push(this._[0].slice())},t.prototype.lineTo=function(t,e){this._.push([t,e])},t.prototype.value=function(){return this._.length?this._:null},t}(),o=function(){function t(t,e){var r=void 0===e?[0,0,960,500]:e,i=r[0],n=r[1],o=r[2],s=r[3];if(!((o=+o)>=(i=+i)&&(s=+s)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length),this.vectors=new Float64Array(t.points.length),this.xmax=o,this.xmin=i,this.ymax=s,this.ymin=n,this._init()}return t.prototype.update=function(){return this.delaunay.update(),this._init(),this},t.prototype._init=function(){for(var t=this.delaunay,e=t.points,r=t.hull,i=t.triangles,n=this.vectors,o=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2),s=0,a=0,h=i.length,c=void 0,u=void 0;s<h;s+=3,a+=2){var l=2*i[s],p=2*i[s+1],f=2*i[s+2],y=e[l],d=e[l+1],_=e[p],v=e[p+1],m=e[f],g=e[f+1],x=_-y,b=v-d,w=m-y,M=g-d,z=x*x+b*b,P=w*w+M*M,A=2*(x*M-b*w);if(A)if(Math.abs(A)<1e-8)c=(y+m)/2,u=(d+g)/2;else{var S=1/A;c=y+(M*z-b*P)*S,u=d+(x*P-w*z)*S}else c=(y+m)/2-1e8*M,u=(d+g)/2+1e8*w;o[a]=c,o[a+1]=u}var O,V,E,B=r[r.length-1],j=4*B,k=e[2*B],N=e[2*B+1];n.fill(0);for(s=0;s<r.length;++s)O=j,V=k,E=N,j=4*(B=r[s]),k=e[2*B],N=e[2*B+1],n[O+2]=n[j]=E-N,n[O+3]=n[j+1]=k-V},t.prototype.cellPolygons=function(){var t,e,r,n;return i(this,(function(i){switch(i.label){case 0:t=this.delaunay.points,e=0,r=t.length/2,i.label=1;case 1:return e<r?(n=this.cellPolygon(e))?(n.index=e,[4,n]):[3,3]:[3,4];case 2:i.sent(),i.label=3;case 3:return++e,[3,1];case 4:return[2]}}))},t.prototype.cellPolygon=function(t){return(new n).value()},t.prototype._renderSegment=function(t,e,r,i,n){var o,s=this._regioncode(t,e),a=this._regioncode(r,i);0===s&&0===a?(n.moveTo(t,e),n.lineTo(r,i)):(o=this._clipSegment(t,e,r,i,s,a))&&(n.moveTo(o[0],o[1]),n.lineTo(o[2],o[3]))},t.prototype.contains=function(t,e,r){return(e=+e)==e&&(r=+r)==r&&this.delaunay._step(t,e,r)===t},t.prototype.neighbors=function(t){var e,r,n,o,s,a,h,c,u;return i(this,(function(i){switch(i.label){case 0:if(!(e=this._clip(t)))return[3,8];r=0,n=this.delaunay.neighbors(t),i.label=1;case 1:if(!(r<n.length))return[3,8];if(o=n[r],!(s=this._clip(o)))return[3,7];a=0,h=e.length,i.label=2;case 2:if(!(a<h))return[3,7];c=0,u=s.length,i.label=3;case 3:return c<u?e[a]!=s[c]||e[a+1]!=s[c+1]||e[(a+2)%h]!=s[(c+u-2)%u]||e[(a+3)%h]!=s[(c+u-1)%u]?[3,5]:[4,o]:[3,6];case 4:return i.sent(),[3,7];case 5:return c+=2,[3,3];case 6:return a+=2,[3,2];case 7:return r++,[3,1];case 8:return[2]}}))},t.prototype._cell=function(t){var e=this.circumcenters,r=this.delaunay,i=r.inedges,n=r.halfedges,o=r.triangles,s=i[t];if(-1===s)return null;var a=[],h=s;do{var c=Math.floor(h/3);if(a.push(e[2*c],e[2*c+1]),o[h=h%3==2?h-2:h+1]!==t)break;h=n[h]}while(h!==s&&-1!==h);return a},t.prototype._clip=function(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var e=this._cell(t);if(null===e)return null;var r=this.vectors,i=4*t;return r[i]||r[i+1]?this._clipInfinite(t,e,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,e)},t.prototype._clipFinite=function(t,e){for(var r,i,n,o,s,a=e.length,h=null,c=e[a-2],u=e[a-1],l=this._regioncode(c,u),p=0;p<a;p+=2)if(r=c,i=u,c=e[p],u=e[p+1],n=l,l=this._regioncode(c,u),0===n&&0===l)o=s,s=0,h?h.push(c,u):h=[c,u];else{var f=void 0,y=void 0,d=void 0,_=void 0,v=void 0;if(0===n){if(null===(f=this._clipSegment(r,i,c,u,n,l)))continue;y=f[0],d=f[1],_=f[2],v=f[3]}else{if(null===(f=this._clipSegment(c,u,r,i,l,n)))continue;_=f[0],v=f[1],y=f[2],d=f[3],o=s,s=this._edgecode(y,d),o&&s&&this._edge(t,o,s,h,h.length),h?h.push(y,d):h=[y,d]}o=s,s=this._edgecode(_,v),o&&s&&this._edge(t,o,s,h,h.length),h?h.push(_,v):h=[_,v]}if(h)o=s,s=this._edgecode(h[0],h[1]),o&&s&&this._edge(t,o,s,h,h.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return h},t.prototype._clipSegment=function(t,e,r,i,n,o){for(;;){if(0===n&&0===o)return[t,e,r,i];if(n&o)return null;var s=void 0,a=void 0,h=n||o;8&h?(s=t+(r-t)*(this.ymax-e)/(i-e),a=this.ymax):4&h?(s=t+(r-t)*(this.ymin-e)/(i-e),a=this.ymin):2&h?(a=e+(i-e)*(this.xmax-t)/(r-t),s=this.xmax):(a=e+(i-e)*(this.xmin-t)/(r-t),s=this.xmin),n?(t=s,e=a,n=this._regioncode(t,e)):(r=s,i=a,o=this._regioncode(r,i))}},t.prototype._clipInfinite=function(t,e,r,i,n,o){var s,a=Array.from(e);if((s=this._project(a[0],a[1],r,i))&&a.unshift(s[0],s[1]),(s=this._project(a[a.length-2],a[a.length-1],n,o))&&a.push(s[0],s[1]),a=this._clipFinite(t,a))for(var h=0,c=a.length,u=void 0,l=this._edgecode(a[c-2],a[c-1]);h<c;h+=2)u=l,l=this._edgecode(a[h],a[h+1]),u&&l&&(h=this._edge(t,u,l,a,h),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a},t.prototype._edge=function(t,e,r,i,n){for(;e!==r;){var o=void 0,s=void 0;switch(e){case 5:e=4;continue;case 4:e=6,o=this.xmax,s=this.ymin;break;case 6:e=2;continue;case 2:e=10,o=this.xmax,s=this.ymax;break;case 10:e=8;continue;case 8:e=9,o=this.xmin,s=this.ymax;break;case 9:e=1;continue;case 1:e=5,o=this.xmin,s=this.ymin}i[n]===o&&i[n+1]===s||!this.contains(t,o,s)||(i.splice(n,0,o,s),n+=2)}if(i.length>4)for(var a=0;a<i.length;a+=2){var h=(a+2)%i.length,c=(a+4)%i.length;(i[a]===i[h]&&i[h]===i[c]||i[a+1]===i[h+1]&&i[h+1]===i[c+1])&&(i.splice(h,2),a-=2)}return n},t.prototype._project=function(t,e,r,i){var n,o,s,a=1/0;if(i<0){if(e<=this.ymin)return null;(n=(this.ymin-e)/i)<a&&(s=this.ymin,o=t+(a=n)*r)}else if(i>0){if(e>=this.ymax)return null;(n=(this.ymax-e)/i)<a&&(s=this.ymax,o=t+(a=n)*r)}if(r>0){if(t>=this.xmax)return null;(n=(this.xmax-t)/r)<a&&(o=this.xmax,s=e+(a=n)*i)}else if(r<0){if(t<=this.xmin)return null;(n=(this.xmin-t)/r)<a&&(o=this.xmin,s=e+(a=n)*i)}return[o,s]},t.prototype._edgecode=function(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)},t.prototype._regioncode=function(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)},t}();e.Voronoi=o},413:function(t,e,r){"use strict";r.d(e,"b",(function(){return s})),r.d(e,"a",(function(){return u}));var i=r(381),n=r(380);function o(t){switch(t){case"Point":case"Vec3":return(new i.Vec3).copy(a());case"Line":return new i.Line(a(),a());case"Ray":return new i.Ray(a(),a().normalize());case"Segment":return new i.Segment(a(),a());case"Polyline":var e=[];for(let t=0;t<Math.floor(100*Math.random()+3);t++)e.push(a());return new i.Polyline(e);case"Triangle":return new i.Triangle(a(200),a(200),a(200));case"Circle":return new i.Circle(a(),60*Math.random()+5,a().normalize());case"Disk":return new i.Disk(a(),60*Math.random()+5,a().normalize());case"Capsule":return new i.Capsule(a(),a())}}function s(t,e,r){var i=o(t),s=o(e),a=i["distance"+e](s);return r.add(c(i)),r.add(c(s)),a.closests&&2===a.closests.length&&r.add(function(t,e){var r=new n.Geometry;r.vertices.push(...t);var i=new n.l({color:16711680,dashSize:1,gapSize:1,scale:1,...e}),o=new n.j(r,i);return o.computeLineDistances(),o}(a.closests)),a}function a(t=100){return i.v3(Math.random()*t-t/2,Math.random()*t,Math.random()*t-t/3)}function h(t,e){var r=t.clone().normalize(),o=e.clone().normalize(),s=r.clone().cross(o).normalize(),a=new n.w,h=i.clamp(r.normalize().dot(o.normalize()),-1,1);return h=Math.acos(h),a.setFromAxisAngle(s,h),a}function c(t,e){var r=null;if(t instanceof i.Point||t.isVec3){(s=new n.c).setAttribute("position",new n.h([t.x,t.y,t.z],3));var o=new n.u({size:5,sizeAttenuation:!1,color:1044720,alphaTest:.9,transparent:!0});r=new n.t(s,o)}else if(t instanceof i.Line){var s=new n.Geometry,a=t.direction.clone().multiplyScalar(1e4).add(t.origin),u=t.direction.clone().multiplyScalar(-1e4).add(t.origin);s.vertices.push(a,u);o=new n.k({color:16777103});r=new n.j(s,o)}else if(t instanceof i.Ray){s=new n.Geometry,a=t.direction.clone().multiplyScalar(1e4).add(t.origin);s.vertices.push(t.origin,a);o=new n.k({color:16748543});r=new n.j(s,o)}else if(t instanceof i.Segment){(s=new n.Geometry).vertices.push(t.p0,t.p1);o=new n.k({color:9437183});r=new n.j(s,o)}else if(t instanceof i.Triangle){(s=new n.Geometry).vertices=[...t],s.faces.push(new n.g(0,1,2));o=new n.p({color:9408511,side:n.e});r=new n.o(s,o)}else if(t instanceof i.Polyline){(s=new n.Geometry).vertices.push(...t);o=new n.k({color:16748543});r=new n.j(s,o)}else if(t instanceof i.Polygon);else if(t instanceof i.Circle){s=new n.Geometry;var l=t.radius;for(let t=0;t<=128;t++){var p=new n.B;p.x=l*Math.cos(Math.PI/64*t),p.y=l*Math.sin(Math.PI/64*t),s.vertices.push(p)}var f=h(new n.B(0,0,1),t.normal);(y=new n.n).makeRotationFromQuaternion(f),s.applyMatrix(y),s.translate(t.center.x,t.center.y,t.center.z);o=new n.k({color:9437183});(r=new n.j(s,o)).add(new c(t.center)),r.add(new c(new i.Ray(t.center,t.normal)))}else if(t instanceof i.Disk){var y;s=new n.d(t.radius,128),o=new n.p({color:9408511,side:n.e}),f=h(new n.B(0,0,1),t.normal);(y=new n.n).makeRotationFromQuaternion(f),s.applyMatrix4(y),s.translate(t.center.x,t.center.y,t.center.z),(r=new n.o(s,o)).add(new c(t.center)),r.add(new c(new i.Ray(t.center,t.normal)))}return r}function u(t,e){var r="",i=0,n=function(t,e){var r=null;if("[object String]"!==Object.prototype.toString.call(t))try{r=JSON.stringify(t)}catch(t){console.error("您传递的json数据格式有误，请核对..."),console.error(t),e(t)}else try{t=t.replace(/(\')/g,'"'),r=JSON.stringify(JSON.parse(t))}catch(t){console.error("您传递的json数据格式有误，请核对..."),console.error(t),e(t)}return r}(t,e);if(!n)return n;var o=[],s=null,a=null,h=[];return n=(n=(n=(n=(n=n.replace(/([\{\}])/g,"\r\n$1\r\n")).replace(/([\[\]])/g,"\r\n$1\r\n")).replace(/(\,)/g,"$1\r\n")).replace(/(\r\n\r\n)/g,"\r\n")).replace(/\r\n\,/g,","),(h=n.split("\r\n")).forEach((function(t,e){var r=t.match(/\"/g)?t.match(/\"/g).length:0;r%2&&!s&&(s=e),r%2&&s&&s!=e&&(a=e),s&&a&&(o.push({start:s,end:a}),s=null,a=null)})),o.reverse().forEach((function(t,e){var r=h.slice(t.start,t.end+1);h.splice(t.start,t.end+1-t.start,r.join(""))})),n=(n=(n=h.join("\r\n")).replace(/\:\r\n\{/g,":{")).replace(/\:\r\n\[/g,":["),(h=n.split("\r\n")).forEach((function(t,e){console.log(t);var n=0,o=0,s="";for(t.match(/\{$/)||t.match(/\[$/)?o+=1:t.match(/\}$/)||t.match(/\]$/)||t.match(/\},$/)||t.match(/\],$/)?0!==i&&(i-=1):o=0,n=0;n<i;n++)s+="    ";r+=s+t+"\r\n",i+=o})),r.trim()}},436:function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.euler=e.Euler=void 0;var o=r(360),s=r(361),a=r(377),h=r(365),c=r(364),u=a.m4(),l=h.quat(),p=function(t){function e(e,r,i,n){void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n="XYZ");var o=t.call(this)||this;return o._x=e,o._y=r,o._z=i,o._order=n,o.isEuler=!0,o}return n(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.fire("change","x",this._x,t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.fire("change","y",this._y,t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this.fire("change","z",this._z,t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"order",{get:function(){return this._order},set:function(t){this._order!==t&&(this.fire("change","order",this._order,t),this._order=t)},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._order=i||this._order,this.fire("change"),this},e.prototype.clone=function(){return new e(this._x,this._y,this._z,this._order)},e.prototype.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.fire("change"),this},e.prototype.setFromRotationMat=function(t,e,r){var i=t.elements,n=i[0],o=i[4],a=i[8],h=i[1],c=i[5],u=i[9],l=i[2],p=i[6],f=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(s.clamp(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-o,n)):(this._x=Math.atan2(p,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-s.clamp(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(h,c)):(this._y=Math.atan2(-l,n),this._z=0)):"ZXY"===e?(this._x=Math.asin(s.clamp(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-l,f),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(h,n))):"ZYX"===e?(this._y=Math.asin(-s.clamp(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(p,f),this._z=Math.atan2(h,n)):(this._x=0,this._z=Math.atan2(-o,c))):"YZX"===e?(this._z=Math.asin(s.clamp(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-l,n)):(this._x=0,this._y=Math.atan2(a,f))):"XZY"===e?(this._z=Math.asin(-s.clamp(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-u,f),this._y=0)):console.warn("Euler: .setFromRotationMat() given unsupported order: "+e),this._order=e,!1!==r&&this.fire("change"),this},e.prototype.setFromQuat=function(t,e,r){return u.makeRotationFromQuat(t),this.setFromRotationMat(u,e,r)},e.prototype.setFromVec3=function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},e.prototype.reorder=function(t){return l.setFromEuler(this),this.setFromQuat(l,t)},e.prototype.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},e.prototype.fromArray=function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.fire("change"),this},e.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},e.prototype.toVec3=function(t){return t?t.set(this._x,this._y,this._z):o.v3(this._x,this._y,this._z)},e}(c.EventHandler);e.Euler=p,e.euler=function(t,e,r){return new p(t,e,r)}},437:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Orientation=e.IntersectType=void 0,function(t){t[t.None=0]="None",t[t.Parallel=1]="Parallel",t[t.Perpendicular=2]="Perpendicular",t[t.Collineation=3]="Collineation"}(e.IntersectType||(e.IntersectType={})),function(t){t[t.None=-1]="None",t[t.Positive=1]="Positive",t[t.Negative=2]="Negative",t[t.Common=3]="Common",t[t.Intersect=3]="Intersect"}(e.Orientation||(e.Orientation={}))},446:function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Vec=void 0;var o=function(t){function e(e){for(var r=t.call(this)||this;e-- >0;)r[r.length]=0;return r}return n(e,t),e.max=function(t){if(0===t.length)return-1/0;for(var e=t[0],r=1,i=t.length;r<i;++r)t[r]>e&&(e=t[r]);return e},e}(Array);e.Vec=o},447:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isBufferArray=void 0,e.isBufferArray=function(t){return["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].indexOf(t.constructor.name)>-1}},449:function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Distance=void 0;var n=r(360),o=i(r(374)),s=(new n.Vec3,function(){function t(){}return t.Point2Point_Number=function(t,e,r,i,n,s){return o.default.distance(t,e,r,i,n,s)},t.Point2Line_Number=function(t,e,r,i,n,o,s,a,h){},t.Point2Line_Vec3=function(t,e,r,i){void 0===i&&(i=new n.Vec3),i.copy(t).sub(e);var o=i.dot(r);return i.copy(r).multiplyScalar(o),i.add(t),i},t}());e.Distance=s},450:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},451:function(t,e,r){"use strict";r(158),r(368),r(369),r(370),r(371);var i=this&&this.__generator||function(t,e){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var n=r(411),o=r(412),s=(Math.PI,Math.pow);function a(t,e,r){return[t+Math.sin(t+e)*r,e+Math.cos(t-e)*r]}var h=function(){function t(t){this._delaunator=new n.Delaunator(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}return t.from=function(e){return new t(new Float64Array(e))},t.prototype.update=function(){return this._delaunator.update(),this._init(),this},t.prototype._init=function(){var t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){for(var e=t.triangles,r=t.coords,i=0;i<e.length;i+=3){var n=2*e[i],o=2*e[i+1],s=2*e[i+2];if((r[s]-r[n])*(r[o+1]-r[n+1])-(r[o]-r[n])*(r[s+1]-r[n+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},(function(t,e){return e})).sort((function(t,r){return e[2*t]-e[2*r]||e[2*t+1]-e[2*r+1]}));for(var r=this.collinear[0],i=this.collinear[this.collinear.length-1],o=[e[2*r],e[2*r+1],e[2*i],e[2*i+1]],s=1e-8*Math.hypot(o[3]-o[1],o[2]-o[0]),h=0,c=e.length/2;h<c;++h){var u=a(e[2*h],e[2*h+1],s);e[2*h]=u[0],e[2*h+1]=u[1]}this._delaunator=new n.Delaunator(e)}else delete this.collinear;var l=this.halfedges=this._delaunator.halfedges,p=this.hull=this._delaunator.hull,f=this.triangles=this._delaunator.triangles,y=this.inedges.fill(-1),d=this._hullIndex.fill(-1);for(r=0,c=l.length;r<c;++r){u=f[r%3==2?r-2:r+1];-1!==l[r]&&-1!==y[u]||(y[u]=r)}for(h=0,c=p.length;h<c;++h)d[p[h]]=h;p.length<=2&&p.length>0&&(this.triangles=new Uint32Array(3).fill(-1),this.halfedges=new Uint32Array(3).fill(-1),this.triangles[0]=p[0],this.triangles[1]=p[1],this.triangles[2]=p[1],y[p[0]]=1,2===p.length&&(y[p[1]]=0))},t.prototype.voronoi=function(t){return new o.Voronoi(this,t)},t.prototype.neighbors=function(t){var e,r,n,o,s,a,h,c,u,l,p,f;return i(this,(function(i){switch(i.label){case 0:return r=(e=this).inedges,n=e.hull,o=e._hullIndex,s=e.halfedges,a=e.triangles,(h=e.collinear)?(c=h.indexOf(t))>0?[4,h[c-1]]:[3,2]:[3,5];case 1:i.sent(),i.label=2;case 2:return c<h.length-1?[4,h[c+1]]:[3,4];case 3:i.sent(),i.label=4;case 4:return[2];case 5:if(-1===(u=r[t]))return[2];l=u,p=-1,i.label=6;case 6:return[4,p=a[l]];case 7:return i.sent(),a[l=l%3==2?l-2:l+1]!==t?[2]:-1!==(l=s[l])?[3,10]:(f=n[(o[t]+1)%n.length])===p?[3,9]:[4,f];case 8:i.sent(),i.label=9;case 9:return[2];case 10:if(l!==u)return[3,6];i.label=11;case 11:return[2]}}))},t.prototype.find=function(t,e,r){if(void 0===r&&(r=0),(t=+t)!=t||(e=+e)!=e)return-1;for(var i,n=r;(i=this._step(r,t,e))>=0&&i!==r&&i!==n;)r=i;return i},t.prototype._step=function(t,e,r){var i=this,n=i.inedges,o=i.hull,a=i._hullIndex,h=i.halfedges,c=i.triangles,u=i.points;if(-1===n[t]||!u.length)return(t+1)%(u.length>>1);var l=t,p=s(e-u[2*t],2)+s(r-u[2*t+1],2),f=n[t],y=f;do{var d=c[y],_=s(e-u[2*d],2)+s(r-u[2*d+1],2);if(_<p&&(p=_,l=d),c[y=y%3==2?y-2:y+1]!==t)break;if(-1===(y=h[y])){if((y=o[(a[t]+1)%o.length])!==d&&s(e-u[2*y],2)+s(r-u[2*y+1],2)<p)return y;break}}while(y!==f);return l},t}();e.default=h},452:function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Capsule=void 0;var o=function(t){function e(e,r,i){void 0===i&&(i=0);var n=t.call(this,e,r)||this;return n.radius=i,n}return n(e,t),e}(r(366).Segment);e.Capsule=o},453:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.disk=e.Disk=void 0;var i=r(360),n=function(){function t(t,e,r){void 0===r&&(r=i.Vec3.UnitY),this.center=t||i.v3(),this.normal=r,this.radius=e||0,this.w=this.normal.dot(t)}return t.prototype.area=function(){return Math.PI*this.radius*this.radius},t}();e.Disk=n,e.disk=function(t,e,r){return new n(t,e,r)}},454:function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Point=void 0;var o=function(t){function e(e,r,i){return void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),t.call(this,e,r,i)||this}return n(e,t),e}(r(360).Vec3);e.Point=o},455:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ray=void 0;var i=r(367),n=function(){function t(t,e){this.origin=t,this.direction=e.normalize()}return t.prototype.distanceRay=function(t){var e,r,i,n={parameters:[],closests:[]},o=this.origin.clone().sub(t.origin),s=-this.direction.dot(t.direction),a=o.dot(this.direction);if(Math.abs(s)<1)if(i=s*a-(e=-o.dot(t.direction)),(r=s*e-a)>=0)if(i>=0){var h=1-s*s;r/=h,i/=h}else i=0,r=a>=0?0:-a;else i>=0?(r=0,i=e>=0?0:-e):a<0?(r=-a,i=0):(r=0,i=e>=0?0:-e);else s>0?(i=0,r=a>=0?0:-a):a>=0?(r=0,i=-(e=-o.dot(t.direction))):(r=-a,i=0);return n.parameters[0]=r,n.parameters[1]=i,n.closests[0]=this.direction.clone().multiplyScalar(r).add(this.origin),n.closests[1]=t.direction.clone().multiplyScalar(i).add(t.origin),o=n.closests[0].clone().sub(n.closests[1]),n.distanceSqr=o.dot(o),n.distance=Math.sqrt(n.distanceSqr),n},t.prototype.distanceSegment=function(t){var e,r,i={parameters:[],closests:[]},n=t.center,o=t.direction,s=.5*t.extent,a=this.origin.clone().sub(n),h=-this.direction.dot(o),c=a.dot(this.direction);if(Math.abs(h)<1){var u=1-h*h,l=s*u,p=-a.dot(o);r=h*c-p,(e=h*p-c)>=0?r>=-l?r<=l?(e/=u,r/=u):(r=s,e=Math.max(-(h*r+c),0)):(r=-s,e=Math.max(-(h*r+c),0)):r<=-l?(e=-(-h*s+c))>0?r=-s:(e=0,(r=-p)<-s?r=-s:r>s&&(r=s)):r<=l?(e=0,(r=-p)<-s?r=-s:r>s&&(r=s)):(e=-(h*s+c))>0?r=s:(e=0,(r=-p)<-s?r=-s:r>s&&(r=s))}else r=h>0?-s:s,e=Math.max(-(h*r+c),0);return i.parameters[0]=e,i.parameters[1]=r,i.closests[0]=this.direction.clone().multiplyScalar(e).add(this.origin),i.closests[1]=o.clone().multiplyScalar(r).add(n),a=i.closests[0].clone().sub(i.closests[1]),i.distanceSqr=a.dot(a),i.distance=Math.sqrt(i.distanceSqr),i},t.prototype.distanceTriangle=function(t){var e={parameters:[],closests:[],triangleParameters:[]},r=new i.Line(this.origin,this.origin.clone().add(this.direction)).distanceTriangle(t);if(r.lineParameter>=0)e.distance=r.distance,e.distanceSqr=r.distanceSqr,e.rayParameter=r.lineParameter,e.triangleParameters[0]=r.triangleParameters[0],e.triangleParameters[1]=r.triangleParameters[1],e.triangleParameters[2]=r.triangleParameters[2],e.closests[0]=r.closests[0],e.closests[1]=r.closests[1];else{var n=this.origin.clone().distanceTriangle(t);e.distance=n.distance,e.distanceSqr=n.distanceSqr,e.rayParameter=0,e.triangleParameters[0]=n.triangleParameters[0],e.triangleParameters[1]=n.triangleParameters[1],e.triangleParameters[2]=n.triangleParameters[2],e.closests[0]=this.origin,e.closests[1]=n.closests[1]}return e},t.prototype.distancePloyline=function(){return{}},t}();e.Ray=n},456:function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Triangle=void 0;var o=function(t){function e(r,i,n){var o=t.call(this)||this;return Object.setPrototypeOf(o,e.prototype),o.push(r,i,n),o}return n(e,t),Object.defineProperty(e.prototype,"p0",{get:function(){return this[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"p1",{get:function(){return this[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"p2",{get:function(){return this[2]},enumerable:!1,configurable:!0}),e.prototype.distanceTriangle=function(t){},e}(Array);e.Triangle=o},457:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Frustum=void 0;var i=r(378),n=new(r(385).Sphere),o=function(){function t(){this.planes=[new i.Plane,new i.Plane,new i.Plane,new i.Plane,new i.Plane,new i.Plane]}return Object.defineProperty(t.prototype,"front",{get:function(){return this.planes[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"back",{get:function(){return this.planes[1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.planes[2]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.planes[3]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.planes[4]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.planes[5]},enumerable:!1,configurable:!0}),t.prototype.setFromProjectionMatrix=function(t){var e=this.planes,r=t.elements,i=r[0],n=r[1],o=r[2],s=r[3],a=r[4],h=r[5],c=r[6],u=r[7],l=r[8],p=r[9],f=r[10],y=r[11],d=r[12],_=r[13],v=r[14],m=r[15];return e[0].setComponents(s-i,u-a,y-l,d-m).normalize(),e[1].setComponents(s+i,u+a,y+l,d+m).normalize(),e[2].setComponents(s+n,u+h,y+p,_+m).normalize(),e[3].setComponents(s-n,u-h,y-p,_-m).normalize(),e[4].setComponents(s-o,u-c,y-f,v-m).normalize(),e[5].setComponents(s+o,u+c,y+f,v+m).normalize(),this},t.fromProjectionMatrix=function(e){return(new t).setFromProjectionMatrix(e)},t.prototype.setFromPerspective=function(t,e,r,i,n,o,s){e.clone().sub(t)},t.prototype.intersectsObject=function(t,e){return t.boundingSphere||t.computeBoundingSphere(),n.copy(t.boundingSphere).applyMat4(e),this.intersectsSphere(n)},t.prototype.intersectsSphere=function(t){for(var e=this.planes,r=t.center,i=-t.radius,n=0;n<6;n++){if(e[n].distancePoint(r)<i)return!1}return!0},t.prototype.intersectsSphereComponents=function(t,e,r,i){return n.setComponents(t,e,r,i),this.intersectsSphere(n)},t.prototype.containsPoint=function(t){for(var e=this.planes,r=0;r<6;r++)if(e[r].distancePoint(t)<0)return!1;return!0},t.prototype.intersectSegment=function(t){for(var e=this.planes,r=0;r<6;r++){var i=e[r].intersectSegmentLw(t);if(null!==i)return i}return null},t.prototype.simpleIntersectVS=function(t){for(var e=this,r=t.map((function(t){return e.containsPoint(t)})),i=[],n=0;n<t.length;n++){var o=t[n],s=r[n];o.index=n,s&&i.push(o)}if(i.length>0){var a=i[0].index,h=i[i.length-1].index;a>0&&i.unshift(t[a-1]),h<t.length-2&&i.push(t[h+1])}return i},t.prototype.copy=function(t){},t.prototype.clone=function(){return(new this.constructor).copy(this)},t}();e.Frustum=o},458:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.linksToGeometry=e.linkToGeometry=e.extrudeToGeometryBuffer=e.toGeometryBuffer=void 0;var i=r(375),n=r(383),o=r(386),s=r(372);function a(t){return i.toGeoBuffer(t.position,t.index,t.uv)}e.toGeometryBuffer=a,e.extrudeToGeometryBuffer=function(t,e,r){var o=n.extrude_obsolete(t,e,r);return i.toGeoBuffer(o.vertices,o.index,o.uvs)},e.linkToGeometry=function(t,e,r,i){return void 0===r&&(r=o.AxisPlane.XY),void 0===i&&(i=!1),a(n.linkSides({shapes:[t,e],shapeClosed:i,orgShape:t,axisPlane:r}))},e.linksToGeometry=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!0);var o=s.flat(t);return i.indexable(o),a(n.linkSides({shapes:t,shapeClosed:e,orgShape:t[0]}))}}}]);